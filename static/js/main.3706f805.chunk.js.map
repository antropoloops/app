{"version":3,"sources":["playback/actions.js","ui/shared/Icon.jsx","ui/shared/index.jsx","ui/Toolbar/Toolbar.jsx","playback/index.js","store/model.js","ui/Toolbar/index.js","ui/Session/NoSession.jsx","ui/Session/HasSession.jsx","ui/shared/Panel.jsx","ui/Session/index.jsx","ui/Pads/Pad.jsx","ui/Pads/Pads.jsx","ui/Pads/index.js","ui/shared/Trigger.jsx","ui/Tracks/Tracks.jsx","ui/Tracks/index.js","audioset/cache.js","audioset/inputs.js","ui/Keyboard/Keyboard.jsx","ui/Keyboard/index.js","ui/App/Help.jsx","ui/App/Display.jsx","ui/App/index.js","browser/localStorage.js","audioset/resources.js","audio/context.js","audio/nextBeat.js","audio/Sampler.js","audio/index.js","store/effects/audio.effects.js","audioset/index.js","store/effects/fullscreen.effects.js","store/effects/room.effects.js","visuals/dimensions.js","visuals/drawCircle.js","visuals/getAlbumInfo.js","visuals/visuals.js","visuals/drawAlbum.js","visuals/drawRefLine.js","visuals/drawWave.js","visuals/imprint.js","visuals/lastSampleInfo.js","visuals/display.js","visuals/index.js","store/effects/visuals.effects.js","store/effects/index.js","store/effects/audioset.effects.js","store/effects/keyboard.effects.js","index.js","store/createStore.js"],"names":["PLAYBACK_PREFIX","name","SYNC_PLAYBACK","syncPlayback","playback","type","setAudioset","audioset","PRESS_PAD","pressPad","clipId","RELEASE_PAD","releasePad","START_AUDIO_CLIP","STOP_AUDIO_CLIP","SET_AUDIO_STARTED","SET_AUDIO_STOPPED","AUDIO_STOP_ALL","CHANGE_TRACK_VOLUME","ICONS","stop","fly","mute","cinema","controls","stop2","fullscreen","keyboard","volumeUp","volumeDown","volumeOff","Icon","_ref","icon","color","onClick","react_default","a","createElement","fill","height","viewBox","width","xmlns","d","Button","cxs","display","background","font","padding",":hover","textDecoration","Link","cursor","border","activeColor","isActive","Transport","Actions","Connection","marginTop","flexGrow","textAlign","Toolbar","flexDirection","backgroundColor","initialAudiosetState","initialAudioState","isPlaying","status","startedAt","valueByTrack","value","tracks","reduce","obj","track","id","initTracksState","playing","volumes","combineReducers","state","arguments","length","undefined","action","audio","Object","objectSpread","time","defineProperty","trackId","dir","changeTrackStatus","changeVolume","INIT_SIDE_EFFECTS","sa","SET_AUDIOSET_INDEX","LOAD_AUDIOSET","TOGGLE_IS_CONTROL","setAudiosetIndex","index","initialSessionState","audiosetIndex","isControl","initialRoomState","user","room","roomList","ra","SET_LOGGED_IN","CREATE_ROOM_REQUEST","SET_CURRENT_ROOM","SET_ROOM_LIST","REQUEST_ROOM","setLoggedIn","setRoom","setRoomList","initialDesktopState","session","pads","help","da","TOGGLE_SESSION","TOGGLE_TRACKS","TOGGLE_PADS","SHOW_HELP","HIDE_HELP","SHOW_FULLSCREEN","SET_FULLSCREEN","SET_WINDOW_SIZE","setSize","size","toggleSession","hideHelp","setFullscreen","isFullscreen","sync","roomId","actions","showHelp","togglePads","toggleTracks","showFullscreen","toggleIsControl","connect","isDesktop","dispatch","bindActionCreators","Toolbar_Toolbar","shared_Icon","meta","title","NoSession","rooms","onOpenAudioset","onJoinRoom","map","set","key","description","HasSession","onCloseAudioset","onRequestRoom","className","Layout","Panel","Section","Header","Footer","Content","Main","openAudioset","audiosetId","closeAudioset","requestRoom","joinRoom","shared_Panel","Session_NoSession","Session_HasSession","Pad","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","touched","isTouch","pressed","_this2","_this$props","touch","image","concat","style","borderColor","onTouchStart","handlePress","onMouseDown","src","alt","React","Component","TrackPads","onPadPressed","onPadReleased","clipIds","ui_Pads_Pad","onPress","onRelease","_ref2","Pads_TrackPads","minHeight","pad","Pads","Trigger","children","onMouseUp","marginRight","&:hover","propTypes","PropTypes","string","Track","component","borderTop","active","> h2","marginBottom","Tracks","onVolumeChanged","shared_Trigger","clips","min","max","onChange","e","target","volume","CACHE","save","startsWith","console","log","get","has","memo","create","ns","cachedFetch","url","decode","Promise","resolve","fetch","then","data","getKeyboardMap","defaults","keyMap","keys","toUpperCase","buildKeymap","Key","Keyboard","steps","content","placement","disableBeacon","locale","back","close","last","next","skip","styles","options","arrowColor","beaconSize","overlayColor","primaryColor","spotlightShadow","textColor","zIndex","tooltip","fontSize","fontFamily","buttonSkip","Help","run","onStop","react_joyride_es","callback","showProgress","showSkipButton","continuous","Mobile","ui_Toolbar","ui_Session","ui_Pads","Desktop","notFull","Fragment","Center","ui_Tracks","ui_Keyboard","lib_default","isOpen","shouldCloseOnOverlayClick","onRequestClose","ModalStyles","overlay","position","maxHeight","top","left","transform","borderRadius","overflow","Display_Mobile","Display_Desktop","STORAGE_KEY","saveState","serializedState","JSON","stringify","localStorage","setItem","window","resetLocalStorage","ENV","process","resourceUrl","source","resources","assign","default","getSources","replace","getCachedResources","cached","all","loadResources","promise","i","resource","getResourceUrls","names","toUrl","urls","identity","x","DECODERS","response","ctx","context","arrayBuffer","buffer","decodeAudioData","decoder","BEATS","nextBeat","now","bpm","beats","factor","absolute","nextBeatOffset","Sampler","events","buffers","sources","output","gain","createGain","destination","createMasterOutput","currentTime","warn","stopTrack","createBufferSource","loop","start","started","stopped","clip","find","forEach","audioStarted","audioClipStarted","audioClipStopeed","audioStopped","mapDispatchToEvents","setAudioStarted","setAudioStopped","startAudioClip","stopAudioClip","AudioEngine","currentSampler","samplers","engine","sampler","getSampler","Resources","changeSampler","stopAll","play","BASE_URL","json","send","ws","msg","albumsCount","DOT_RADIUS","getVerticalPadding","screenWidth","getInfoHeight","getCoverSize","getAlbumHeight","verticalPadding","infoHeight","getDotOffsetX","trackNumber","RATIOS","sixteenNinths","sixteenTenths","circleNumSlices","degreesFromSlice","d3","range","domain","drawCircle","parent","cx","cy","params","duration","trackVolume","trackColor","circlesGroup","append","attr","circle","arc","outerArcs","startAngle","deg2rad","endAngle","innerRadius","outerRadius","createOuterArcs","selectAll","enter","innerArcs","createInnerArcs","turnTimer","elapsed","elapsedSeconds","turnScale","empty","degrees","Math","PI","getAlbumInfo","imageUrl","getClipCoverImageUrl","lnglat","year","country","artist","album","trackNum","loopend","CONFIG","geoMapUrl","imprint","focus","lambda","verticalShift","scaleFactor","remove","group","Display","config","visuals","circles","albums","refLines","infos","fixedAspectRatio","render","bind","geodata","countries","topojson","objects","features","info","_this$display$dimensi","dimensions","_this$projection","projection","_this$projection2","slicedToArray","circlesContainer","el","coverSize","horizontalPadding","dotOffsetX","textElement","textId","textLength","document","getElementById","getBBox","text","slice","wrap","drawAlbum","albumsContainer","refLine","windowWidth","x1","x2","y2","h","sqrt","pow","alfa","acos","curveCoords","y","cos","sin","line","curve","datum","drawRefLine","refLinesContainer","firstRadius","floor","radius","wave","r","strokeWidth","transition","delay","on","nodes","lastRadius","drawWave","wavesContainer","point","lastSampleInfo","screenHeight","select","rectSize","dy","createLastSampleInfo","lastSampleInfoContainer","each","polygon","base","chroma","brighten","clear","_this$display$dimensi2","focusedScale","scale","albumsHeight","svg","mapContainer","d3geo","translate","rotate","createProjection","path","RATIO","isVisible","w","offsetWidth","offsetHeight","realAspectRatio","calculateDimensions","src_visuals","init","setAttribute","body","appendChild","current","setVisible","Visuals","setGeodata","createVisuals","removeVisuals","startClip","show","stopClip","hide","store_effects","isRoom","store","isInternalAction","clientId","isPlayback","isWebSocketOpen","readyState","WebSocket","OPEN","payload","broadcastAction","getState","onopen","onmessage","event","parse","from","enabled","Audio","restoreState","setEnabled","playSample","stopSample","baseUrl","fetchIndex","fetchAudioset","screen","resize","throttle","innerWidth","innerHeight","addEventListener","onkeydown","onkeyup","initialState","getItem","loadState","fxLen","effects","devTools","__REDUX_DEVTOOLS_EXTENSION__","f","enhancer","compose","applyMiddleware","createStore","reducer","subscribe","getStateToSave","element","Modal","setAppElement","ReactDOM","es","App"],"mappings":"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","file":"static/js/main.3706f805.chunk.js","sourcesContent":["export const PLAYBACK_PREFIX = \"[playback] \";\nconst name = name => PLAYBACK_PREFIX + name;\n\n// Audioset\n\nexport const SYNC_PLAYBACK = name(\"SYNC_PLAYBACK\");\nexport const syncPlayback = playback => ({ type: SYNC_PLAYBACK, playback });\nexport const setAudioset = audioset => ({\n  type: SYNC_PLAYBACK,\n  playback: { audioset }\n});\n\n// Pads\nexport const PRESS_PAD = name(\"PRESS_PAD\");\nexport const pressPad = clipId => ({ type: PRESS_PAD, clipId });\nexport const RELEASE_PAD = name(\"RELEASE_PAD\");\nexport const releasePad = clipId => ({ type: RELEASE_PAD, clipId });\n\n// Audio\nexport const START_AUDIO_CLIP = name(\"START_AUDIO_CLIP\");\nexport const startAudioClip = (clipId, trackId, time) => ({\n  type: START_AUDIO_CLIP,\n  clipId,\n  trackId,\n  status: { isPlaying: true, time }\n});\nexport const STOP_AUDIO_CLIP = name(\"STOP_AUDIO_CLIP\");\nexport const stopAudioClip = (clipId, trackId, time) => ({\n  type: STOP_AUDIO_CLIP,\n  clipId,\n  trackId,\n  status: { isPlaying: false, time }\n});\n\nexport const SET_AUDIO_STARTED = name(\"SET_AUDIO_STARTED\");\nexport const setAudioStarted = time => ({\n  type: SET_AUDIO_STARTED,\n  time\n});\nexport const SET_AUDIO_STOPPED = name(\"SET_AUDIO_STOPPED\");\nexport const setAudioStopped = time => ({\n  type: SET_AUDIO_STOPPED,\n  time\n});\n\nexport const AUDIO_STOP_ALL = name(\"AUDIO_STOP_ALL\");\nexport const stopAudio = () => ({\n  type: AUDIO_STOP_ALL\n});\n\n// Tracks\nexport const CHANGE_TRACK_VOLUME = name(\"CHANGE_TRACK_VOLUME\");\nexport const changeTrackVolume = (trackId, volume) => ({\n  type: CHANGE_TRACK_VOLUME,\n  trackId,\n  volume\n});\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\n// http://svgicons.sparkk.fr/\nconst ICONS = {\n  stop: \"M6 6h12v12H6z\",\n  fly:\n    \"M17.218,2.268L2.477,8.388C2.13,8.535,2.164,9.05,2.542,9.134L9.33,10.67l1.535,6.787c0.083,0.377,0.602,0.415,0.745,0.065l6.123-14.74C17.866,2.46,17.539,2.134,17.218,2.268 M3.92,8.641l11.772-4.89L9.535,9.909L3.92,8.641z M11.358,16.078l-1.268-5.613l6.157-6.157L11.358,16.078z\",\n  mute:\n    \"M18.084,11.639c0.168,0.169,0.168,0.442,0,0.611c-0.084,0.084-0.195,0.127-0.306,0.127c-0.111,0-0.221-0.043-0.306-0.127l-1.639-1.639l-1.639,1.639c-0.084,0.084-0.195,0.127-0.306,0.127c-0.111,0-0.222-0.043-0.307-0.127c-0.168-0.169-0.168-0.442,0-0.611L15.223,10l-1.64-1.639c-0.168-0.168-0.168-0.442,0-0.61c0.17-0.169,0.442-0.169,0.612,0l1.639,1.639l1.639-1.639c0.169-0.169,0.442-0.169,0.611,0c0.168,0.168,0.168,0.442,0,0.61L16.445,10L18.084,11.639z M12.161,2.654v14.691c0,0.175-0.105,0.333-0.267,0.4c-0.054,0.021-0.109,0.032-0.166,0.032c-0.111,0-0.223-0.043-0.305-0.127l-3.979-3.979H2.222c-0.237,0-0.432-0.194-0.432-0.432V6.759c0-0.237,0.195-0.432,0.432-0.432h5.222l3.979-3.978c0.123-0.125,0.309-0.163,0.471-0.095C12.056,2.322,12.161,2.479,12.161,2.654 M7.192,7.192H2.654v5.617h4.538V7.192z M11.296,3.698l-3.24,3.241v6.123l3.24,3.24V3.698z\",\n  cinema:\n    \"M18.175,4.142H1.951C1.703,4.142,1.5,4.344,1.5,4.592v10.816c0,0.247,0.203,0.45,0.451,0.45h16.224c0.247,0,0.45-0.203,0.45-0.45V4.592C18.625,4.344,18.422,4.142,18.175,4.142 M4.655,14.957H2.401v-1.803h2.253V14.957zM4.655,12.254H2.401v-1.803h2.253V12.254z M4.655,9.549H2.401V7.747h2.253V9.549z M4.655,6.846H2.401V5.043h2.253V6.846zM14.569,14.957H5.556V5.043h9.013V14.957z M17.724,14.957h-2.253v-1.803h2.253V14.957z M17.724,12.254h-2.253v-1.803h2.253V12.254zM17.724,9.549h-2.253V7.747h2.253V9.549z M17.724,6.846h-2.253V5.043h2.253V6.846z\",\n  controls:\n    \"M6.176,7.241V6.78c0-0.221-0.181-0.402-0.402-0.402c-0.221,0-0.403,0.181-0.403,0.402v0.461C4.79,7.416,4.365,7.955,4.365,8.591c0,0.636,0.424,1.175,1.006,1.35v3.278c0,0.222,0.182,0.402,0.403,0.402c0.222,0,0.402-0.181,0.402-0.402V9.941c0.582-0.175,1.006-0.714,1.006-1.35C7.183,7.955,6.758,7.416,6.176,7.241 M5.774,9.195c-0.332,0-0.604-0.272-0.604-0.604c0-0.332,0.272-0.604,0.604-0.604c0.332,0,0.604,0.272,0.604,0.604C6.377,8.923,6.105,9.195,5.774,9.195 M10.402,10.058V6.78c0-0.221-0.181-0.402-0.402-0.402c-0.222,0-0.402,0.181-0.402,0.402v3.278c-0.582,0.175-1.006,0.714-1.006,1.35c0,0.637,0.424,1.175,1.006,1.351v0.461c0,0.222,0.181,0.402,0.402,0.402c0.221,0,0.402-0.181,0.402-0.402v-0.461c0.582-0.176,1.006-0.714,1.006-1.351C11.408,10.772,10.984,10.233,10.402,10.058M10,12.013c-0.333,0-0.604-0.272-0.604-0.604S9.667,10.805,10,10.805c0.332,0,0.604,0.271,0.604,0.604S10.332,12.013,10,12.013M14.629,8.448V6.78c0-0.221-0.182-0.402-0.403-0.402c-0.221,0-0.402,0.181-0.402,0.402v1.668c-0.581,0.175-1.006,0.714-1.006,1.35c0,0.636,0.425,1.176,1.006,1.351v2.07c0,0.222,0.182,0.402,0.402,0.402c0.222,0,0.403-0.181,0.403-0.402v-2.07c0.581-0.175,1.006-0.715,1.006-1.351C15.635,9.163,15.21,8.624,14.629,8.448 M14.226,10.402c-0.331,0-0.604-0.272-0.604-0.604c0-0.332,0.272-0.604,0.604-0.604c0.332,0,0.604,0.272,0.604,0.604C14.83,10.13,14.558,10.402,14.226,10.402 M17.647,3.962H2.353c-0.221,0-0.402,0.181-0.402,0.402v11.27c0,0.222,0.181,0.402,0.402,0.402h15.295c0.222,0,0.402-0.181,0.402-0.402V4.365C18.05,4.144,17.869,3.962,17.647,3.962 M17.245,15.232H2.755V4.768h14.49V15.232z\",\n  stop2:\n    \"M10 0c-5.523 0-10 4.477-10 10s4.477 10 10 10 10-4.477 10-10-4.477-10-10-10zM10 18.125c-4.487 0-8.125-3.638-8.125-8.125s3.638-8.125 8.125-8.125 8.125 3.638 8.125 8.125-3.638 8.125-8.125 8.125zM6.25 6.25h7.5v7.5h-7.5z\",\n  fullscreen:\n    \"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z\",\n  keyboard:\n    \"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z\",\n  volumeUp:\n    \"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\",\n  volumeDown:\n    \"M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z\",\n  volumeOff:\n    \"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z\"\n};\n\nconst Icon = ({ icon, color, onClick }) => (\n  <svg\n    fill={color || \"#CCC\"}\n    onClick={onClick}\n    height=\"20\"\n    viewBox=\"0 0 20 20\"\n    width=\"20\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path d={ICONS[icon] || icon} />\n  </svg>\n);\n\nIcon.propTypes = {\n  icon: PropTypes.string,\n  color: PropTypes.string,\n  onClick: PropTypes.func\n};\n\nexport default Icon;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport cxs from \"cxs/component\";\nexport { default as Icon } from \"./Icon\";\n\nexport const Json = ({ obj }) => <pre>{JSON.stringify(obj)}</pre>;\nJson.propTypes = {\n  obj: PropTypes.object\n};\n\nexport const Button = cxs(\"button\")({\n  color: \"black\",\n  display: \"block\",\n  background: \"white\",\n  font: \"inherit\",\n  padding: \"0 1em\",\n  \":hover\": {\n    textDecoration: \"underline\"\n  }\n});\n\nexport const Link = cxs(\"button\")({\n  color: \"white\",\n  cursor: \"pointer\",\n  display: \"block\",\n  background: \"none\",\n  font: \"inherit\",\n  border: 0,\n  \":hover\": {\n    textDecoration: \"underline\"\n  }\n});\n","import React from \"react\";\nimport cxs from \"cxs/component\";\nimport { Icon } from \"../shared\";\n\nconst activeColor = isActive => (isActive ? \"white\" : \"gray\");\n\nexport default ({\n  audioset,\n  isControl,\n  isDesktop,\n  display,\n  toggleSession,\n  showHelp,\n  togglePads,\n  toggleTracks,\n  toggleIsControl,\n  showFullscreen\n}) => (\n  <Toolbar>\n    <div>{isDesktop && <Icon icon=\"fly\" onClick={showHelp} />}</div>\n    <Connection id=\"Connection\" onClick={toggleSession}>\n      {audioset.meta.title}\n    </Connection>\n    {isDesktop && (\n      <Transport id=\"Transport\">\n        {<Icon icon=\"stop\" />}\n        <Icon icon=\"mute\" />\n      </Transport>\n    )}\n    {isDesktop && (\n      <Actions>\n        <Icon\n          icon=\"mute\"\n          onClick={toggleIsControl}\n          color={isControl ? \"gray\" : \"green\"}\n        />\n        <Icon\n          icon=\"controls\"\n          color={activeColor(display.pads)}\n          onClick={togglePads}\n        />\n        <Icon\n          icon=\"controls\"\n          color={activeColor(display.tracks)}\n          onClick={toggleTracks}\n        />\n        <Icon\n          icon=\"cinema\"\n          color={activeColor(display.fullscreen)}\n          onClick={showFullscreen}\n        />\n      </Actions>\n    )}\n  </Toolbar>\n);\n\nconst Transport = cxs(\"div\")();\nconst Actions = cxs(\"div\")();\nconst Connection = cxs(\"div\")({\n  marginTop: \"3px\",\n  flexGrow: 1,\n  textAlign: \"center\"\n});\n\nconst Toolbar = cxs(\"div\")({\n  display: \"flex\",\n  flexDirection: \"row\",\n  backgroundColor: \"black\",\n  padding: \"2px 10px\"\n});\n","import { combineReducers } from \"redux\";\n\nimport {\n  SET_AUDIO_STARTED,\n  START_AUDIO_CLIP,\n  STOP_AUDIO_CLIP,\n  AUDIO_STOP_ALL,\n  SYNC_PLAYBACK,\n  CHANGE_TRACK_VOLUME,\n  SET_AUDIO_STOPPED\n} from \"./actions\";\n\n/**\n * Audioset session state\n */\nconst initialAudiosetState = null;\n\nexport function audioset(state = initialAudiosetState, action) {\n  switch (action.type) {\n    case SYNC_PLAYBACK:\n      return action.playback.audioset;\n    default:\n      return state;\n  }\n}\n\n/**\n * Audioset session state\n */\nconst initialAudioState = {\n  isPlaying: false,\n  status: \"STOP\",\n  startedAt: null\n};\n\nexport function audio(state = initialAudioState, action) {\n  switch (action.type) {\n    case SET_AUDIO_STARTED:\n      return { ...state, status: \"PLAYING\", startedAt: action.time };\n    case SET_AUDIO_STOPPED:\n      return { ...state, status: \"STOP\", startedAt: null };\n    case START_AUDIO_CLIP:\n    case STOP_AUDIO_CLIP:\n      return {\n        ...state,\n        status: { ...state.status, [action.clipId]: action.status }\n      };\n    case AUDIO_STOP_ALL:\n      return { ...state, status: {} };\n    default:\n      return state;\n  }\n}\n\nexport function tracks(state = initTracksState(), action) {\n  switch (action.type) {\n    case SYNC_PLAYBACK:\n      return initTracksState(action.playback.audioset);\n    case START_AUDIO_CLIP:\n    case STOP_AUDIO_CLIP:\n      return changeTrackStatus(state, action.trackId, action.status);\n    case CHANGE_TRACK_VOLUME:\n      return changeVolume(state, action.trackId, action.value);\n    default:\n      return state;\n  }\n}\n\nconst valueByTrack = (audioset, value) =>\n  audioset.tracks.reduce((obj, track) => {\n    obj[track.id] = value;\n    return obj;\n  }, {});\n\nfunction initTracksState(audioset) {\n  return audioset\n    ? {\n        playing: valueByTrack(audioset, 0),\n        volumes: valueByTrack(audioset, 75)\n      }\n    : { playing: {}, volumes: {} };\n}\n\nfunction changeTrackStatus(state, trackId, status) {\n  const dir = status.isPlaying ? 1 : -1;\n  return {\n    ...state,\n    playing: {\n      ...state.playing,\n      [trackId]: state.playing[trackId] + dir\n    }\n  };\n}\n\nfunction changeVolume(state, trackId, value) {\n  return {\n    ...state,\n    volumes: { ...state.volumes, [trackId]: value }\n  };\n}\n\nexport default combineReducers({\n  audioset,\n  audio,\n  tracks\n});\n","import { combineReducers } from \"redux\";\nimport playback from \"../playback\";\nimport { SYNC_PLAYBACK } from \"../playback/actions\";\n\nexport const INIT_SIDE_EFFECTS = \"INIT_SIDE_EFFECTS\";\n\nconst sa = name => \"/session/\" + name;\nexport const SET_AUDIOSET_INDEX = sa(\"SET_AUDIOSET_INDEX\");\nexport const LOAD_AUDIOSET = sa(\"LOAD_AUDIOSET\");\nexport const TOGGLE_IS_CONTROL = sa(\"TOGGLE_IS_CONTROL\");\n\nexport const setAudiosetIndex = index => ({ type: SET_AUDIOSET_INDEX, index });\nexport const toggleIsControl = () => ({ type: TOGGLE_IS_CONTROL });\n// side effects\nexport const loadAudioset = id => ({ type: LOAD_AUDIOSET, id });\n\nconst initialSessionState = {\n  audiosetIndex: null,\n  isControl: false\n};\n\nfunction session(state = initialSessionState, action) {\n  switch (action.type) {\n    case SET_AUDIOSET_INDEX:\n      return { ...state, audiosetIndex: action.index };\n    case TOGGLE_IS_CONTROL:\n      return { ...state, isControl: !state.isControl };\n    default:\n      return state;\n  }\n}\n\nconst initialRoomState = {\n  user: null,\n  room: null,\n  roomList: []\n};\n\nconst ra = name => \"/sync/\" + name;\nexport const SET_LOGGED_IN = ra(\"SET_LOGGED_IN\");\nexport const CREATE_ROOM_REQUEST = ra(\"CREATE_ROOM_REQUEST\");\nexport const SET_CURRENT_ROOM = ra(\"SET_CURRENT_ROOM\");\nexport const SET_ROOM_LIST = ra(\"SET_ROOM_LIST\");\nexport const REQUEST_ROOM = ra(\"REQUEST_ROOM\");\n\nexport const setLoggedIn = user => ({ type: SET_LOGGED_IN, user });\nexport const createRoom = () => ({ type: CREATE_ROOM_REQUEST });\nexport const setRoom = room => ({ type: SET_CURRENT_ROOM, room });\nexport const setRoomList = roomList => ({ type: SET_ROOM_LIST, roomList });\nexport const joinRoom = room => ({ type: REQUEST_ROOM, room });\n\nfunction sync(state = initialRoomState, action) {\n  switch (action.type) {\n    case SET_LOGGED_IN:\n      return {\n        ...state,\n        user: action.user,\n        room:\n          state.room && state.room.id === action.user.roomId ? state.room : null\n      };\n    case SET_CURRENT_ROOM:\n      return { ...state, room: action.room };\n    case SET_ROOM_LIST:\n      return {\n        ...state,\n        roomList: action.roomList\n      };\n    default:\n      return state;\n  }\n}\n\nconst initialDesktopState = {\n  session: true,\n  pads: false,\n  tracks: false,\n  help: false,\n  fullscreen: false\n};\nconst da = name => \"/display/\" + name;\nexport const TOGGLE_SESSION = da(\"SHOW_SESSION\");\nexport const TOGGLE_TRACKS = da(\"TOGGLE_TRACKS\");\nexport const TOGGLE_PADS = da(\"TOGGLE_PADS\");\nexport const SHOW_HELP = da(\"SHOW_HELP\");\nexport const HIDE_HELP = da(\"HIDE_HELP\");\nexport const SHOW_FULLSCREEN = da(\"SHOW_FULLSCREEN\");\nexport const SET_FULLSCREEN = da(\"SET_FULLSCREEN\");\nexport const SET_WINDOW_SIZE = da(\"SET_WINDOW_SIZE\");\n\nexport const setSize = (width, height) => ({\n  type: SET_WINDOW_SIZE,\n  size: { width, height }\n});\nexport const toggleSession = () => ({ type: TOGGLE_SESSION });\nexport const toggleTracks = () => ({ type: TOGGLE_TRACKS });\nexport const togglePads = () => ({ type: TOGGLE_PADS });\nexport const showHelp = () => ({ type: SHOW_HELP });\nexport const hideHelp = () => ({ type: HIDE_HELP });\nexport const showFullscreen = () => ({ type: SHOW_FULLSCREEN });\nexport const setFullscreen = isFullscreen => ({\n  type: SET_FULLSCREEN,\n  isFullscreen\n});\n\nfunction display(state = initialDesktopState, action) {\n  switch (action.type) {\n    case SET_WINDOW_SIZE:\n      return { ...state, type: action.size.width < 700 ? \"mobile\" : \"desktop\" };\n    case SYNC_PLAYBACK:\n    case TOGGLE_SESSION:\n      return { ...state, session: !state.session };\n    case SHOW_HELP:\n      return { ...state, help: true };\n    case HIDE_HELP:\n      return { ...state, help: false };\n    case TOGGLE_PADS:\n      return { ...state, pads: !state.pads };\n    case TOGGLE_TRACKS:\n      return { ...state, tracks: !state.tracks };\n    case SET_FULLSCREEN:\n      return { ...state, fullscreen: action.isFullscreen };\n    default:\n      return state;\n  }\n}\n\nexport default combineReducers({ playback, session, display, sync });\n","import { bindActionCreators } from \"redux\";\nimport { connect } from \"react-redux\";\n\nimport Toolbar from \"./Toolbar\";\nimport {\n  showHelp,\n  hideHelp,\n  toggleSession,\n  togglePads,\n  toggleTracks,\n  showFullscreen,\n  toggleIsControl\n} from \"../../store/model\";\n\nconst actions = {\n  toggleSession,\n  showHelp,\n  hideHelp,\n  togglePads,\n  toggleTracks,\n  showFullscreen,\n  toggleIsControl\n};\n\nconst mapStateToProps = state => ({\n  audioset: state.playback.audioset,\n  isControl: state.session.isControl,\n  display: state.display,\n  isDesktop: state.display.type === \"desktop\"\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators(actions, dispatch);\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Toolbar);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Link } from \"../shared\";\n\nconst NoSession = ({ audiosetIndex, rooms, onOpenAudioset, onJoinRoom }) => (\n  <div>\n    <h2>Empieza una nueva remezcla</h2>\n    {audiosetIndex.map(set => (\n      <Link key={set.id} onClick={() => onOpenAudioset(set.id)}>\n        {set.meta.title}: {set.meta.description}\n      </Link>\n    ))}\n    <h2>Conctate a una en marcha</h2>\n    {rooms.length\n      ? rooms.map(room => (\n          <Link key={room.id} onClick={() => onJoinRoom(room)}>\n            {room.name}\n          </Link>\n        ))\n      : \"No hay otras sesiones activas en este momento.\"}\n  </div>\n);\nNoSession.propTypes = {\n  audiosetIndex: PropTypes.array,\n  onOpenAudioset: PropTypes.func\n};\n\nexport default NoSession;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Button } from \"../shared\";\n\nconst HasSession = ({ audioset, onCloseAudioset, room, onRequestRoom }) => (\n  <div className=\"Session\">\n    <h1>{audioset.meta.title}</h1>\n    <p>{audioset.meta.description}</p>\n    {room ? (\n      <h2>Room: {room.name}</h2>\n    ) : (\n      <Button onClick={onRequestRoom}>Request room</Button>\n    )}\n    <Button onClick={onCloseAudioset}>Cerrar audioset</Button>\n  </div>\n);\nHasSession.propTypes = {\n  onCloseAudioset: PropTypes.func\n};\n\nexport default HasSession;\n","import cxs from \"cxs/component\";\n\nconst Layout = cxs(\"div\")({\n  display: \"flex\",\n  flexDirection: \"column\"\n});\n\nconst Panel = cxs(Layout)({\n  backgroundColor: \"black\",\n  padding: \"1em\"\n});\n\nPanel.Layout = Layout;\n\nPanel.Section = Panel.Header = Panel.Footer = cxs(\"div\")({\n  backgroundColor: \"black\"\n});\n\nPanel.Content = Panel.Main = cxs(\"div\")({\n  flexGrow: 1\n});\n\nexport default Panel;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { setAudioset } from \"../../playback/actions\";\nimport { loadAudioset, createRoom, joinRoom } from \"../../store/model\";\nimport NoSession from \"./NoSession\";\nimport HasSession from \"./HasSession\";\nimport Panel from \"../shared/Panel\";\n\nconst Session = ({\n  audioset,\n  audiosetIndex,\n  openAudioset,\n  closeAudioset,\n  room,\n  rooms,\n  requestRoom,\n  joinRoom\n}) => {\n  return (\n    <Panel id=\"Session\">\n      <Panel.Header>\n        <h1>Bienvenidx a Antropoloops</h1>\n      </Panel.Header>\n      <Panel.Content>\n        {audiosetIndex && !audioset && (\n          <NoSession\n            audiosetIndex={audiosetIndex}\n            onOpenAudioset={openAudioset}\n            rooms={rooms}\n            onJoinRoom={joinRoom}\n          />\n        )}\n\n        {audioset && (\n          <HasSession\n            audioset={audioset}\n            room={room}\n            onRequestRoom={requestRoom}\n            onCloseAudioset={closeAudioset}\n          />\n        )}\n      </Panel.Content>\n    </Panel>\n  );\n};\n\nconst mapStateToProps = state => ({\n  audioset: state.playback.audioset,\n  audiosetIndex: state.session.audiosetIndex,\n  room: state.sync.room,\n  rooms: state.sync.roomList\n});\nconst mapDispatchToProps = dispatch => ({\n  openAudioset: audiosetId => dispatch(loadAudioset(audiosetId)),\n  closeAudioset: () => dispatch(setAudioset(null)),\n  requestRoom: () => dispatch(createRoom()),\n  joinRoom: room => dispatch(joinRoom(room))\n});\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Session);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./Pad.css\";\n\nclass Pad extends React.Component {\n  constructor(props) {\n    super(props);\n    this.touched = false;\n  }\n\n  handlePress(isTouch) {\n    // prevent double click on mobile (https://github.com/facebook/react/issues/9809)\n    if (isTouch) {\n      this.touched = true;\n    } else if (this.touched === true) {\n      this.touched = false;\n      return;\n    }\n    const pressed = !this.props.pressed;\n    this.props[pressed ? \"onPress\" : \"onRelease\"](this.props.name);\n  }\n\n  render() {\n    const { color, pressed, touch, image, name } = this.props;\n    return (\n      <button\n        className={`Pad ${pressed ? \"pressed\" : \"\"}`}\n        style={{\n          borderColor: color\n        }}\n        onTouchStart={touch ? () => this.handlePress(true) : undefined}\n        onMouseDown={() => this.handlePress(false)}\n      >\n        {image ? <img src={image} alt={name} /> : \"\"}\n      </button>\n    );\n  }\n}\n\nPad.propTypes = {\n  name: PropTypes.string,\n  color: PropTypes.string,\n  prtessed: PropTypes.bool,\n  touch: PropTypes.bool,\n  image: PropTypes.string\n};\n\nexport const EmptyPad = ({ name }) => (\n  <button className=\"Pad\" style={{ borderColor: \"transparent\" }}>\n    {name}\n  </button>\n);\n\nexport default Pad;\n","import React from \"react\";\nimport cxs from \"cxs/component\";\nimport PropTypes from \"prop-types\";\nimport Pad from \"./Pad\";\n\nconst TrackPads = ({ track, status, onPadPressed, onPadReleased }) => (\n  <div>\n    {track.clipIds.map(name => (\n      <Pad\n        key={name}\n        name={name}\n        pressed={status[name] && status[name].isPlaying}\n        color={track.color}\n        onPress={onPadPressed}\n        onRelease={onPadReleased}\n      />\n    ))}\n  </div>\n);\n\nconst Pads = ({ audioset, status, className, onPadPressed, onPadReleased }) => {\n  return (\n    <div className={className} id=\"Pads\">\n      {audioset.tracks.map(track => (\n        <TrackPads\n          key={track.name}\n          track={track}\n          status={status}\n          onPadPressed={onPadPressed}\n          onPadReleased={onPadReleased}\n        />\n      ))}\n    </div>\n  );\n};\nPads.propTypes = {\n  onPadPressed: PropTypes.func\n};\nexport default cxs(Pads)({\n  backgroundColor: \"black\",\n  width: \"100%\",\n  padding: \"1em\",\n  minHeight: \"100%\"\n});\n","import { connect } from \"react-redux\";\nimport Pads from \"./Pads\";\nimport { pressPad, releasePad } from \"../../playback/actions\";\n\nconst mapStateToProps = state => ({\n  audioset: state.playback.audioset,\n  status: state.playback.audio.status\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onPadPressed: pad => dispatch(pressPad(pad)),\n  onPadReleased: pad => dispatch(releasePad(pad))\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Pads);\n","import React from \"react\";\nimport cxs from \"cxs/component\";\nimport PropTypes from \"prop-types\";\n\nconst Base = ({ onPress, onRelease, className, children }) => (\n  <button className={className} onMouseDown={onPress} onMouseUp={onRelease}>\n    {children}\n  </button>\n);\nBase.propTypes = {\n  pressed: PropTypes.bool,\n  onPress: PropTypes.func,\n  onRelease: PropTypes.func\n};\n\nconst Trigger = cxs(Base)(props => ({\n  border: `2px solid ${props.color}`,\n  color: props.color,\n  backgroundColor: props.pressed ? props.color : \"black\",\n  marginRight: \"0.5em\",\n  padding: \"1px 3px\",\n  \"&:hover\": {\n    backgroundColor: props.color,\n    color: \"black\"\n  }\n}));\n\nTrigger.propTypes = {\n  color: PropTypes.string\n};\n\nexport default Trigger;\n","import React from \"react\";\nimport cxs from \"cxs\";\nimport component from \"cxs/component\";\nimport PropTypes from \"prop-types\";\nimport Trigger from \"../shared/Trigger\";\n\nconst Track = component(\"div\")(props => ({\n  color: props.color,\n  borderTop: `2px solid ${props.active ? props.color : \"black\"}`,\n  \"> h2\": {\n    marginTop: \"5px\"\n  },\n  marginBottom: \"1em\"\n}));\n\nconst className = cxs({ padding: \"1em\", backgroundColor: \"black\" });\n\nconst Tracks = ({\n  audioset,\n  volumes,\n  playing,\n  status,\n  onVolumeChanged,\n  onPress,\n  onRelease\n}) => (\n  <div className={className}>\n    <h2>Tracks</h2>\n    {audioset.tracks.map(track => (\n      <Track key={track.id} active={playing[track.id]} color={track.color}>\n        <h2>{track.id}</h2>\n        <div>\n          {track.clipIds.map(clipId => (\n            <Trigger\n              key={clipId}\n              pressed={status[clipId] && status[clipId].isPlaying}\n              onPress={() => onPress(clipId)}\n              onRelease={() => onRelease(clipId)}\n              color={audioset.clips[clipId].display.color}\n            >\n              {clipId}\n            </Trigger>\n          ))}\n        </div>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"100\"\n          value={volumes[track.id]}\n          onChange={e => onVolumeChanged(track.id, e.target.value)}\n        />\n      </Track>\n    ))}\n  </div>\n);\n\nTracks.propTypes = {\n  audio: PropTypes.object\n};\n\nexport default Tracks;\n","import { connect } from \"react-redux\";\nimport Tracks from \"./Tracks\";\nimport {\n  changeTrackVolume,\n  pressPad,\n  releasePad\n} from \"../../playback/actions\";\n\nconst mapStateToProps = state => ({\n  audioset: state.playback.audioset,\n  status: state.playback.audio.status,\n  volumes: state.playback.tracks.volumes,\n  playing: state.playback.tracks.playing\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onVolumeChanged: (track, value) => dispatch(changeTrackVolume(track, value)),\n  onPress: pad => dispatch(pressPad(pad)),\n  onRelease: pad => dispatch(releasePad(pad))\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Tracks);\n","const CACHE = [];\n\nfunction save(key, value) {\n  if (key.startsWith(\"audioset://\")) console.log(\"save\", key, value);\n  CACHE[key] = value;\n  return value;\n}\nfunction get(key) {\n  return CACHE[key];\n}\nfunction has(key) {\n  return CACHE[key] !== undefined;\n}\n\n/**\n * Memoize for audiosets\n * @param {*} key\n * @param {*} create\n */\nexport function memo(audioset, key, create) {\n  const ns = `audioset://${audioset.id}/${key}`;\n  return has(ns) ? get(ns) : save(ns, create());\n}\n\nexport function cachedFetch(url, decode) {\n  if (has(url)) return Promise.resolve(get(url));\n  // console.log(\"Fetch\", url);\n  return fetch(url)\n    .then(decode)\n    .then(data => save(url, data));\n}\n","import { memo } from \"./cache\";\nimport { pressPad, releasePad } from \"../playback/actions\";\n\nexport function init(dispatch, getState) {\n  const pressed = {};\n\n  window.onkeydown = function(e) {\n    const key = e.key;\n    if (pressed[key]) return;\n\n    pressed[key] = true;\n    const audioset = getState().playback.audioset;\n    if (!audioset) return;\n\n    const keyMap = getKeyboardMap(audioset);\n    const clip = keyMap[key];\n    if (clip) dispatch(pressPad(clip.clipId));\n  };\n\n  window.onkeyup = function(e) {\n    const key = e.key;\n    pressed[key] = false;\n\n    const audioset = getState().playback.audioset;\n    if (!audioset) return;\n\n    const keyMap = getKeyboardMap(audioset);\n    const clip = keyMap[key];\n    if (clip) dispatch(releasePad(clip.clipId));\n  };\n}\n\nexport function getKeyboardMap(audioset) {\n  return memo(audioset, \"keyboardMap\", () => buildKeymap(audioset.keyboard));\n}\n\nfunction buildKeymap(keyboard) {\n  if (!keyboard) return {};\n  const { defaults, keyMap } = keyboard;\n  return Object.keys(keyMap).reduce((map, key) => {\n    const value = { ...defaults, ...keyMap[key] };\n    value.key = key;\n    map[key] = value;\n    map[key.toUpperCase()] = value;\n    map[value.clipId] = value;\n    return map;\n  }, {});\n}\n","import React from \"react\";\nimport cxs from \"cxs/component\";\nimport PropTypes from \"prop-types\";\nimport { getKeyboardMap } from \"../../audioset/inputs\";\nimport Trigger from \"../shared/Trigger\";\n\nconst Key = cxs(Trigger)(props => ({\n  marginRight: \"0.5em\",\n  padding: \"1px 3px\"\n}));\n\nconst Keyboard = ({ audioset, status, className, onPress, onRelease }) => {\n  const keyMap = getKeyboardMap(audioset);\n  return (\n    <div className={className} id=\"Keyboard\">\n      {audioset.tracks.map(track =>\n        track.clipIds.map(name => (\n          <Key\n            key={name}\n            pressed={status[name] && status[name].isPlaying}\n            color={track.color}\n            onPress={() => onPress(name)}\n            onRelease={() => onRelease(name)}\n          >\n            {keyMap[name] ? keyMap[name].key.toUpperCase() : \"-\"}\n          </Key>\n        ))\n      )}\n    </div>\n  );\n};\nKeyboard.propTypes = {\n  onKeyPressed: PropTypes.func\n};\nexport default cxs(Keyboard)({\n  backgroundColor: \"black\",\n  textAlign: \"center\",\n  padding: \"2px 10px 4px 10px\"\n});\n","import { connect } from \"react-redux\";\nimport Keyboard from \"./Keyboard\";\nimport { pressPad, releasePad } from \"../../playback/actions\";\n\nconst mapStateToProps = state => ({\n  audioset: state.playback.audioset,\n  status: state.playback.audio.status\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onPress: pad => dispatch(pressPad(pad)),\n  onRelease: pad => dispatch(releasePad(pad))\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Keyboard);\n","import React from \"react\";\nimport Joyride from \"react-joyride\";\n\nconst steps = [\n  {\n    target: \"#Connection\",\n    content:\n      \"Has creado una sesin. Puedes cambiarla o conectar con otros dispositivos aqu\",\n    placement: \"bottom\",\n    disableBeacon: true\n  },\n  {\n    target: \"#Keyboard\",\n    content:\n      \"Usa el teclado para lanzar los sonidos. Tambin puedes usar MIDI o un MakeyMakey!\",\n    placement: \"top\",\n    disableBeacon: true\n  },\n  {\n    target: \"#Transport\",\n    content: \"Ponlo en pantalla completa o abre los controles\",\n    disableBeacon: true\n  }\n];\n\nconst locale = {\n  back: \"Anterior\",\n  close: \"Cerrar\",\n  last: \"Ok, lo he pillado\",\n  next: \"Siguiente\",\n  skip: \"Salir\"\n};\n\nconst options = {\n  arrowColor: \"#111\",\n  backgroundColor: \"#111\",\n  beaconSize: 70,\n  overlayColor: \"rgba(255, 255, 255, 0.5)\",\n  primaryColor: \"#000\",\n  spotlightShadow: \"0 0 15px rgba(0, 0, 0, 0.5)\",\n  textColor: \"white\",\n  width: undefined,\n  zIndex: 100\n};\n\nconst styles = {\n  options,\n  tooltip: { fontSize: 14, fontFamily: \"system\" },\n  buttonSkip: { fontSize: 12 }\n};\n\nexport default ({ run, onStop }) => (\n  <Joyride\n    callback={state => state.action === \"reset\" && onStop()}\n    run={run}\n    locale={locale}\n    styles={styles}\n    showProgress={false}\n    showSkipButton={true}\n    continuous={true}\n    steps={steps}\n  />\n);\n","import React from \"react\";\nimport cxs from \"cxs/component\";\nimport Toolbar from \"../Toolbar\";\nimport Session from \"../Session\";\nimport Pads from \"../Pads\";\nimport Tracks from \"../Tracks\";\nimport Keyboard from \"../Keyboard\";\nimport Modal from \"react-modal\";\nimport Help from \"./Help\";\n\nexport default props =>\n  props.display.type === \"mobile\" ? (\n    <Mobile {...props} />\n  ) : (\n    <Desktop {...props} />\n  );\n\nconst Mobile = ({ audioset, display }) => (\n  <Main>\n    {audioset && <Toolbar />}\n    <Content>{display.session ? <Session /> : <Pads />}</Content>\n  </Main>\n);\n\nconst Desktop = ({ audioset, display, toggleSession, hideHelp }) => {\n  const notFull = !display.fullscreen;\n\n  return (\n    <>\n      {audioset && (\n        <Main className=\"App\">\n          <Help run={display.help} onStop={hideHelp} />\n          {notFull && <Toolbar />}\n          <Content>\n            {notFull && display.pads && <Pads />}\n            <Center />\n            {notFull && display.tracks && <Tracks />}\n          </Content>\n          {notFull && <Keyboard />}\n        </Main>\n      )}\n      <Modal\n        isOpen={!audioset || display.session}\n        shouldCloseOnOverlayClick={true}\n        onRequestClose={toggleSession}\n        style={ModalStyles}\n      >\n        <Session />\n      </Modal>\n    </>\n  );\n};\n\nconst ModalStyles = {\n  overlay: {\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n    zIndex: 900\n  },\n  content: {\n    // http://lynn.io/2014/02/22/modalin/\n    position: \"fixed\",\n    maxHeight: \"calc(100% - 100px)\",\n    top: \"50%\",\n    left: \"50%\",\n    transform: \"translate(-50%, -50%)\",\n\n    // position: \"absolute\",\n    // top: \"40px\",\n    // left: \"0px\",\n    // right: \"auto\",\n    // bottom: \"40px\",\n    border: \"\",\n    background: \"black\",\n    borderRadius: 0,\n    zIndex: 1000\n  }\n};\n\nconst Main = cxs(\"div\")({\n  display: \"flex\",\n  flexDirection: \"column\",\n  minHeight: \"100vh\"\n});\n\nconst Content = cxs(\"div\")({\n  display: \"flex\",\n  flexGrow: 1,\n  flexDirection: \"row\",\n  height: \"100%\",\n  minHeight: \"100%\",\n  maxHeight: \"100%\",\n  overflow: \"hidden\"\n});\n\nconst Center = cxs(\"div\")({\n  flexGrow: 1\n});\n","import { bindActionCreators } from \"redux\";\nimport { connect } from \"react-redux\";\nimport Display from \"./Display\";\nimport { toggleSession, hideHelp } from \"../../store/model\";\n\nconst actions = {\n  toggleSession,\n  hideHelp\n};\n\nconst mapStateToProps = state => ({\n  audioset: state.playback.audioset,\n  display: state.display\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators(actions, dispatch);\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Display);\n","const STORAGE_KEY = \"atpls/session\";\n\nexport function loadState() {\n  try {\n    const serializedState = localStorage.getItem(STORAGE_KEY);\n    if (serializedState === null) return undefined;\n    return JSON.parse(serializedState);\n  } catch (e) {\n    return undefined;\n  }\n}\n\nexport const saveState = state => {\n  try {\n    const serializedState = JSON.stringify(state);\n    localStorage.setItem(STORAGE_KEY, serializedState);\n  } catch (e) {\n    console.log(\"Error saving state\", e);\n  }\n};\n\nif (typeof window !== undefined) {\n  // to clear the storage manually\n  window.resetLocalStorage = () => saveState({});\n}\n","import { cachedFetch, memo } from \"./cache\";\nimport context from \"audio-context\";\n\nconst ENV = process.env.NODE_ENV;\n\nfunction getSources(audioset) {\n  const resources = audioset.resources || {};\n  return Object.assign({}, resources.default, resources[ENV]);\n}\nconst url = source => name => source && source.replace(\"{{filename}}\", name);\nconst resourceUrl = (audioset, type) => url(getSources(audioset)[type] || \"\");\n\nexport default { getCachedResources, loadResources, getResourceUrls };\n\nexport function getResourceUrls(audioset, type) {\n  const names = Object.keys(audioset.clips);\n  const toUrl = resourceUrl(audioset, type);\n  return names.reduce((urls, name) => {\n    urls[name] = toUrl(name);\n    return urls;\n  }, {});\n}\n\nconst identity = x => x;\nconst DECODERS = {\n  audio: decodeAudio\n};\n\nexport function loadResources(audioset, type, clipIds) {\n  clipIds = clipIds || Object.keys(audioset.clips);\n  const toUrl = resourceUrl(audioset, type);\n  const decoder = DECODERS[type] || identity;\n  return clipIds.map(clipId => cachedFetch(toUrl(clipId), decoder));\n}\n\nexport function getCachedResources(audioset, type) {\n  return memo(audioset, type, () => {\n    const cached = {};\n    const clipIds = Object.keys(audioset.clips);\n    Promise.all(\n      loadResources(audioset, type, clipIds).map((promise, i) =>\n        promise.then(resource => {\n          cached[clipIds[i]] = resource;\n          return resource;\n        })\n      )\n    );\n    return cached;\n  });\n}\n\nfunction decodeAudio(response) {\n  const ctx = context();\n  return response.arrayBuffer().then(buffer => ctx.decodeAudioData(buffer));\n}\n","import context from \"audio-context\";\n\nconst ctx = context();\n\nexport default ctx;\n","const BEATS = 1;\n\nexport default function nextBeat(now, startedAt, bpm) {\n  return now + nextBeatOffset(now, startedAt, bpm);\n}\n\n/**\n * Calculate the time remaining until the next beat\n *\n * @param {*} now\n * @param {*} startedAt\n * @param {*} bpm\n * @param {*} beats\n */\nexport function nextBeatOffset(now, startedAt, bpm, beats = BEATS) {\n  if (!startedAt) return 0;\n  const factor = bpm / (60 * beats);\n  const absolute = now - startedAt;\n  if (absolute === 0) return 0;\n  const inBeats = absolute * factor;\n  const mod = inBeats % 1;\n  const offsetTime = (1 - mod) / factor;\n  return offsetTime;\n}\n","import ctx from \"./context\";\nimport nextBeat from \"./nextBeat\";\n\nconst noop = () => undefined;\nexport const EVENTS = {\n  audioClipStarted: noop\n};\n\nexport default class Sampler {\n  constructor(audioset, events) {\n    this.bpm = audioset.audio.bpm || 120;\n    this.playing = 0;\n    this.startedAt = null;\n    this.audioset = audioset;\n    this.buffers = {};\n    this.sources = {};\n    this.events = events;\n    this.output = createMasterOutput(0.2);\n  }\n\n  play(clipId, time) {\n    time = time || nextBeat(ctx.currentTime, this.startedAt, this.bpm);\n    const buffer = this.buffers[clipId];\n    if (!buffer) console.warn(\"No buffer\", clipId);\n\n    this.stopTrack(clipId, time);\n    const source = (this.sources[clipId] = ctx.createBufferSource());\n    source.buffer = buffer;\n    source.loop = true;\n    source.connect(this.output);\n    source.start(time);\n    this.started(clipId, time);\n  }\n  stop(clipId, time) {\n    const source = this.sources[clipId];\n    if (!source) return;\n    time = time || ctx.currentTime;\n    source.stop(time);\n    this.sources[clipId] = null;\n    this.stopped(clipId, time);\n  }\n\n  // stops the clips in the same track\n  stopTrack(clipId, time) {\n    const clip = this.audioset.clips[clipId];\n    const track = this.audioset.tracks.find(track => track.id === clip.trackId);\n    track.clipIds.forEach(clipId => this.stop(clipId, time));\n  }\n\n  stopAll() {\n    const now = ctx.currentTime;\n    Object.keys(this.sources).forEach(clipId => this.stop(clipId, now));\n  }\n\n  started(clipId, time) {\n    if (this.playing === 0) {\n      this.startedAt = time;\n      this.events.audioStarted(time);\n    }\n    this.playing++;\n    const { trackId } = this.audioset.clips[clipId];\n    this.events.audioClipStarted(clipId, trackId, ctx.currentTime);\n  }\n\n  stopped(clipId, time) {\n    const { trackId } = this.audioset.clips[clipId];\n    this.events.audioClipStopeed(clipId, trackId, ctx.currentTime);\n    this.playing--;\n    if (this.playing === 0) {\n      this.startedAt = null;\n      this.events.audioStopped(false, time);\n    }\n  }\n}\n\nfunction createMasterOutput(gain) {\n  const output = ctx.createGain();\n  output.gain.value = gain;\n  output.connect(ctx.destination);\n  return output;\n}\n","import Resources from \"../audioset/resources\";\nimport Sampler from \"./Sampler\";\nimport {\n  startAudioClip,\n  setAudioStarted,\n  stopAudioClip,\n  setAudioStopped\n} from \"../playback/actions\";\n\nconst mapDispatchToEvents = dispatch => ({\n  audioStarted: time => dispatch(setAudioStarted(time)),\n  audioStopped: time => dispatch(setAudioStopped(false, time)),\n  audioClipStarted: (clipId, trackId, time) =>\n    dispatch(startAudioClip(clipId, trackId, time)),\n  audioClipStopeed: (clipId, trackId, time) =>\n    dispatch(stopAudioClip(clipId, trackId, time))\n});\n\nexport default class AudioEngine {\n  constructor(dispatch) {\n    this.events = mapDispatchToEvents(dispatch);\n    this.currentSampler = null;\n    this.samplers = {};\n  }\n\n  restoreState(playback) {\n    const { audioset } = playback;\n    if (audioset) {\n      changeSampler(this, audioset);\n      // Eventually, we have to do it better\n      this.currentSampler.stopAll();\n    }\n  }\n\n  playSample(clipId) {\n    if (!this.currentSampler) return console.warn(\"NO sampler!\");\n    this.currentSampler.play(clipId);\n  }\n\n  stopSample(id, events) {\n    if (!this.currentSampler) return console.warn(\"NO sampler!\");\n    this.currentSampler.stop(id);\n  }\n\n  stopAll() {\n    if (this.currentSampler) this.currentSampler.stopAll();\n  }\n}\n\n// PRIVATE //\n\nfunction getSampler(engine, audioset) {\n  const { id } = audioset;\n  if (engine.samplers[id]) return engine.samplers[id];\n  engine.samplers[id] = new Sampler(audioset, engine.events);\n  return engine.samplers[id];\n}\n\nfunction changeSampler(engine, audioset) {\n  if (audioset) {\n    const sampler = getSampler(engine, audioset);\n    sampler.buffers = Resources.getCachedResources(audioset, \"audio\");\n    engine.currentSampler = sampler;\n  } else {\n    engine.currentSampler = null;\n  }\n}\n","import {\n  SYNC_PLAYBACK,\n  PRESS_PAD,\n  RELEASE_PAD,\n  AUDIO_STOP_ALL\n} from \"../../playback/actions\";\nimport { INIT_SIDE_EFFECTS, TOGGLE_IS_CONTROL } from \"../model\";\n\n// it will change with code-split\nimport Audio from \"../../audio\";\nlet audio = null;\n\nexport default function effects(action, { getState, dispatch }) {\n  const state = getState();\n  const enabled = !state.session.isControl;\n\n  switch (action.type) {\n    case INIT_SIDE_EFFECTS:\n      audio = new Audio(dispatch, enabled);\n      enabled && audio.restoreState(state.playback);\n      break;\n\n    case TOGGLE_IS_CONTROL:\n      audio.setEnabled(enabled);\n      break;\n\n    case SYNC_PLAYBACK:\n      enabled && audio.restoreState(action.playback);\n      break;\n\n    case PRESS_PAD:\n      return enabled && audio.playSample(action.clipId);\n\n    case RELEASE_PAD:\n      return enabled && audio.stopSample(action.clipId);\n\n    case AUDIO_STOP_ALL:\n      return enabled && audio.stopAll();\n\n    default:\n  }\n}\n","import { memo, cachedFetch } from \"./cache\";\nimport { getResourceUrls } from \"./resources\";\n\nconst BASE_URL = (process.env.PUBLIC_URL || \"\") + \"/audiosets\";\nconst json = response => response.json();\n\nexport function getClipCoverImageUrl(audioset, clipId) {\n  const coverUrls = memo(audioset, \"coverUrls\", () =>\n    getResourceUrls(audioset, \"covers\")\n  );\n  return coverUrls[clipId];\n}\n\nexport function fetchIndex(baseUrl = BASE_URL) {\n  const url = `${baseUrl}/audioset.index.json`;\n  return cachedFetch(url, json);\n}\n\nexport function fetchAudioset(audiosetId, baseUrl = BASE_URL) {\n  const url = `${baseUrl}/${audiosetId}.audioset.json`;\n  return cachedFetch(url, json);\n}\n","import { throttle } from \"lodash\";\nimport * as screen from \"screenfull\";\nimport {\n  SHOW_FULLSCREEN,\n  INIT_SIDE_EFFECTS,\n  setFullscreen,\n  setSize\n} from \"../model\";\n\nfunction init(dispatch) {\n  if (screen.enabled) {\n    screen.on(\"change\", () => dispatch(setFullscreen(screen.isFullscreen)));\n  }\n\n  const resize = throttle(\n    () => dispatch(setSize(window.innerWidth, window.innerHeight)),\n    1000\n  );\n  window.addEventListener(\"resize\", resize);\n  resize();\n}\n\nexport default function(action, { dispatch }) {\n  switch (action.type) {\n    case SHOW_FULLSCREEN:\n      screen.enabled && screen.request();\n      break;\n\n    case INIT_SIDE_EFFECTS:\n      init(dispatch);\n      break;\n\n    default:\n      break;\n  }\n}\n","import {\n  CREATE_ROOM_REQUEST,\n  INIT_SIDE_EFFECTS,\n  setRoom,\n  setRoomList,\n  setLoggedIn,\n  REQUEST_ROOM,\n  SET_CURRENT_ROOM\n} from \"../model\";\nimport { syncPlayback, PLAYBACK_PREFIX } from \"../../playback/actions\";\n\nconst send = (ws, msg) => ws.send(JSON.stringify(msg));\n\nfunction init({ dispatch, getState }) {\n  const ws = new WebSocket(\"ws://localhost:8080\");\n\n  ws.onopen = () => {\n    const state = getState();\n    const { user } = state.sync;\n    send(ws, { action: \"login\", payload: user && user.id });\n  };\n\n  ws.onmessage = event => {\n    const data = JSON.parse(event.data);\n    console.log(\"RECEIVED\", data);\n    switch (data.event) {\n      case \"@sync/loggedIn\":\n        return dispatch(setLoggedIn(data.payload));\n      case \"@sync/roomList\":\n        return dispatch(setRoomList(data.payload));\n      case \"@sync/requestJoin\":\n        send(ws, { action: \"acceptJoin\", payload: data.payload.id });\n        const action = syncPlayback(getState().playback);\n        send(ws, { action: \"broadcastAction\", payload: action });\n        return;\n      case \"@sync/joined\":\n        return dispatch(setRoom(data.payload));\n      case \"@sync/action\":\n        // FIXME: filter actions!\n        return dispatch(Object.assign(data.payload, { clientId: data.from }));\n      default:\n        return;\n    }\n  };\n  return ws;\n}\n\nfunction broadcastAction(ws, action, store) {\n  const isInternalAction = !action.clientId;\n  const isPlayback = action.type.startsWith(PLAYBACK_PREFIX);\n  const isWebSocketOpen = ws.readyState === WebSocket.OPEN;\n\n  if (isInternalAction && isPlayback && isWebSocketOpen) {\n    send(ws, { action: \"broadcastAction\", payload: action });\n  }\n}\n\nexport default function(url) {\n  let ws;\n  let isRoom = false;\n  return function(action, store) {\n    isRoom && broadcastAction(ws, action, store);\n    switch (action.type) {\n      case INIT_SIDE_EFFECTS:\n        ws = init(store);\n        break;\n      case CREATE_ROOM_REQUEST:\n        ws.send(JSON.stringify({ action: \"createRoom\" }));\n        break;\n      case REQUEST_ROOM:\n        ws.send(\n          JSON.stringify({ action: \"requestJoin\", payload: action.room.id })\n        );\n        break;\n      case SET_CURRENT_ROOM:\n        isRoom = true;\n        break;\n\n      default:\n        break;\n    }\n  };\n}\n","import * as d3geo from \"d3-geo-projection\";\n\nconst albumsCount = 8;\nexport const DOT_RADIUS = 2;\n\nexport function getHorizontalPadding(screenWidth) {\n  return screenWidth / 300;\n}\n\nexport function getVerticalPadding(screenWidth) {\n  return screenWidth / 450;\n}\n\nexport function getInfoHeight(screenWidth) {\n  return screenWidth / 50;\n}\n\nexport function getCoverSize(screenWidth) {\n  return screenWidth / albumsCount;\n}\n\nexport function getAlbumHeight(screenWidth) {\n  const verticalPadding = getVerticalPadding(screenWidth);\n  const infoHeight = getInfoHeight(screenWidth);\n  return getCoverSize(screenWidth) + verticalPadding + infoHeight * 2;\n}\n\nexport function getDotOffsetX(screenWidth, trackNumber) {\n  return trackNumber * getCoverSize(screenWidth) + DOT_RADIUS;\n}\n\nexport const RATIOS = {\n  sixteenNinths: 16 / 9,\n  sixteenTenths: 16 / 10\n};\n\nexport function createProjection(width, height, scale, verticalShift, lambda) {\n  return d3geo\n    .geoRobinson()\n    .scale(scale)\n    .translate([width / 2, height / 2 + height / verticalShift])\n    .rotate([lambda, 0, 0]);\n}\n","import * as d3 from \"d3\";\n\n// Number of slices in a circle\nconst circleNumSlices = 36;\n\n// Scale. Get the degrees for a specific slice\nconst degreesFromSlice = d3\n  .scaleLinear()\n  .range([0, 360]) // working in degrees\n  .domain([0, circleNumSlices]);\n\nexport default function drawCircle(parent, screenWidth, cx, cy, params) {\n  const { duration, trackVolume, trackColor } = params;\n  const circlesGroup = parent\n    .append(\"g\")\n    .attr(\"class\", \"circleGroup\")\n    .attr(\"transform\", `translate(${cx}, ${cy})`);\n\n  // We need to group again, so that the circle turns in its location\n  const circle = circlesGroup.append(\"g\").attr(\"class\", \"circle\");\n\n  // Arc generator\n  const arc = d3.arc();\n\n  // Create outerArcs data\n  const outerArcs = createOuterArcs(circleNumSlices, screenWidth, trackVolume);\n\n  // Draw outerArcs\n  circle\n    .selectAll(\".outerArcs\")\n    .data(outerArcs)\n    .enter()\n    .append(\"path\")\n    .attr(\"class\", \"outerArcs\")\n    .attr(\"d\", arc)\n    .style(\"fill\", trackColor)\n    .style(\"opacity\", (d, i) => {\n      return (0.3 / circleNumSlices) * i;\n    });\n\n  // Create innerArcs data\n  const innerArcs = createInnerArcs(circleNumSlices, screenWidth, trackVolume);\n\n  // Draw innerArcs\n  circle\n    .selectAll(\".innerArcs\")\n    .data(innerArcs)\n    .enter()\n    .append(\"path\")\n    .attr(\"class\", \"innerArcs\")\n    .attr(\"d\", arc)\n    .style(\"fill\", trackColor)\n    .style(\"opacity\", (d, i) => {\n      return (1 / circleNumSlices) * i;\n    });\n\n  circle\n    .append(\"line\")\n    .attr(\"x1\", 0)\n    .attr(\"y1\", 0)\n    .attr(\"x2\", 0)\n    .attr(\"y2\", -((screenWidth / 30) * trackVolume + screenWidth / 350))\n    .style(\"stroke\", trackColor)\n    .style(\"stroke-width\", 1.5);\n\n  // Add animation to make the circle turn\n  const turnTimer = d3.timer(turn);\n  function turn(elapsed) {\n    const elapsedSeconds = (elapsed / 1000) % duration;\n    const turnScale = d3\n      .scaleLinear()\n      .range([1, 0])\n      .domain([0, duration]);\n    circle.style(\"transform\", `rotate(${-turnScale(elapsedSeconds)}turn)`);\n    if (d3.select(\".circle\").empty()) {\n      turnTimer.stop();\n    }\n  }\n\n  return circlesGroup;\n}\n\nfunction createInnerArcs(circleNumSlices, screenWidth, trackVolume) {\n  return d3.range(circleNumSlices).map((d, i) => {\n    return {\n      startAngle: deg2rad(degreesFromSlice(d)),\n      endAngle:\n        i === circleNumSlices - 1\n          ? deg2rad(degreesFromSlice(d + 1))\n          : deg2rad(degreesFromSlice(d + 2)),\n      innerRadius: 0,\n      outerRadius: (screenWidth / 30) * trackVolume\n    };\n  });\n}\n\nfunction createOuterArcs(circleNumSlices, screenWidth, trackVolume) {\n  return d3.range(circleNumSlices).map((d, i) => {\n    return {\n      startAngle: deg2rad(degreesFromSlice(d)),\n      endAngle:\n        i === circleNumSlices - 1\n          ? deg2rad(degreesFromSlice(d + 1))\n          : deg2rad(degreesFromSlice(d + 2)),\n      innerRadius: 0,\n      outerRadius: (screenWidth / 30) * trackVolume * 2\n    };\n  });\n}\n\n// Transform degrees into radians\nfunction deg2rad(degrees) {\n  return degrees * (Math.PI / 180);\n}\n","import { getClipCoverImageUrl } from \"../audioset\";\n\n/**\n * Get URL of a resource, given it's name and source\n * @param {*} name\n * @param {*} source\n */\nexport function resourceUrl(name, source) {\n  if (!source || !source.length) return name;\n  const url = source[source.length - 1].replace(\"{{filename}}\", name);\n  return url;\n}\n\nexport default function getAlbumInfo(audioset, name) {\n  const clip = audioset.clips[name];\n  if (!clip) return;\n\n  const imageUrl = getClipCoverImageUrl(audioset, clip.name);\n  const bpm = audioset.meta.bpm || 120;\n\n  return {\n    lnglat: clip.lnglat,\n    year: clip.year,\n    country: clip.country,\n    title: clip.title,\n    artist: clip.artist,\n    album: clip.album,\n    trackNumber: clip.trackNum,\n    loopend: 1,\n    trackVolume: clip.audio.trackVolume || 0.7,\n    duration: (60 * clip.audio.beats) / bpm, // clip duration in seconds\n    imageUrl,\n    trackColor: clip.display.color\n  };\n}\n","import * as d3 from \"d3\";\nimport * as topojson from \"topojson\";\n\nimport { RATIOS, createProjection, getAlbumHeight } from \"./dimensions\";\n\nimport drawCircle from \"./drawCircle\";\nimport drawAlbum from \"./drawAlbum\";\nimport drawRefLine from \"./drawRefLine\";\nimport drawWave from \"./drawWave\";\nimport { createLastSampleInfo } from \"./lastSampleInfo\";\nimport { createImprint } from \"./imprint\";\nimport getAlbumInfo from \"./getAlbumInfo\";\n\nconst CONFIG = {\n  geoMapUrl: \"https://unpkg.com/world-atlas@1.1.4/world/110m.json\",\n  imprint: false,\n  focus: {\n    lambda: -10,\n    verticalShift: 15,\n    scaleFactor: 1\n  }\n};\n\nconst remove = (name, group) => {\n  const value = group[name];\n  if (value) {\n    value.remove();\n    group[name] = null;\n  }\n};\n\n/**\n * It stores the state required to render visualizations\n */\nexport default class Display {\n  constructor(set, display) {\n    this.config = Object.assign({}, CONFIG, set.visuals);\n    this.set = set;\n    this.display = display;\n    this.circles = {};\n    this.albums = {};\n    this.refLines = {};\n    this.infos = {};\n    this.fixedAspectRatio = RATIOS.sixteenTenths;\n    this.render = this.render.bind(this);\n  }\n\n  setGeodata(geodata) {\n    this.geodata = geodata;\n    this.countries = topojson.feature(\n      geodata,\n      geodata.objects.countries\n    ).features;\n    this.render();\n  }\n\n  show(name) {\n    const info = getAlbumInfo(this.set, name);\n    if (!info) return;\n\n    const { width, height } = this.display.dimensions;\n    let [cx, cy] = this.projection(info.lnglat);\n\n    const circle = drawCircle(this.circlesContainer, width, cx, cy, info);\n    this.circles[name] = circle;\n\n    const album = drawAlbum(this.albumsContainer, width, info);\n    this.albums[name] = album;\n\n    const refLine = drawRefLine(\n      this.refLinesContainer,\n      width,\n      cx,\n      cy,\n      info.trackNumber,\n      info.trackColor\n    );\n    this.refLines[name] = refLine;\n\n    drawWave(\n      this.wavesContainer,\n      width,\n      cx,\n      cy,\n      info.trackColor,\n      info.trackVolume\n    );\n\n    const lastSampleInfo = createLastSampleInfo(\n      this.lastSampleInfoContainer,\n      width,\n      height,\n      info\n    );\n    this.infos[name] = lastSampleInfo;\n\n    if (this.config.imprint) createImprint(info.lnglat, info.trackColor);\n  }\n\n  hide(name) {\n    remove(name, this.circles);\n    remove(name, this.albums);\n    remove(name, this.refLines);\n    remove(name, this.infos);\n  }\n\n  render() {\n    this.display.clear();\n    const { width, height, scale } = this.display.dimensions;\n    const focusedScale = scale * this.config.focus.scaleFactor;\n    const lambda = this.config.focus.lambda;\n    const verticalShift = this.config.focus.verticalShift;\n    const albumsHeight = getAlbumHeight(width);\n\n    const svg = this.display.svg;\n\n    this.mapContainer = svg\n      .append(\"g\")\n      .attr(\"transform\", `translate(0, ${albumsHeight})`)\n      .append(\"g\")\n      .attr(\"id\", \"map\");\n\n    this.albumsContainer = svg.append(\"g\").attr(\"id\", \"albums\");\n    this.refLinesContainer = svg\n      .append(\"g\")\n      .attr(\"id\", \"refLines\")\n      .attr(\"transform\", `translate(0, ${albumsHeight})`);\n    this.circlesContainer = svg\n      .append(\"g\")\n      .attr(\"transform\", `translate(0, ${albumsHeight})`)\n      .append(\"g\")\n      .attr(\"id\", \"circles\");\n    this.wavesContainer = svg\n      .append(\"g\")\n      .attr(\"id\", \"waves\")\n      .attr(\"transform\", `translate(0, ${albumsHeight})`);\n    this.lastSampleInfoContainer = svg\n      .append(\"g\")\n      .attr(\"id\", \"lastSampleInfo\")\n      .attr(\"transform\", `translate(0, ${albumsHeight})`);\n\n    // Draw map\n    if (this.geodata) {\n      this.projection = createProjection(\n        width,\n        height - albumsHeight,\n        focusedScale,\n        verticalShift,\n        lambda\n      );\n      const path = d3.geoPath().projection(this.projection);\n      this.mapContainer\n        .selectAll(\".countries\")\n        .data(this.countries)\n        .enter()\n        .append(\"path\")\n        .attr(\"id\", d => `country${d.id}`)\n        .attr(\"class\", \"countries\")\n        .attr(\"d\", path)\n        .style(\"stroke\", \"#2c2c2c\")\n        .style(\"stroke-width\", 0.5)\n        .style(\"fill\", d => (d.id === \"010\" ? \"none\" : \"#888888\")); // 010 Antartica\n    }\n  }\n}\n","import {\n  getCoverSize,\n  getHorizontalPadding,\n  getVerticalPadding,\n  getInfoHeight,\n  getDotOffsetX,\n  DOT_RADIUS\n} from \"./dimensions\";\n\nexport default function drawAlbum(el, width, params) {\n  const { trackNumber, imageUrl, year, country, trackColor } = params;\n  const album = el.append(\"g\");\n  const coverSize = getCoverSize(width);\n  const horizontalPadding = getHorizontalPadding(width);\n  const verticalPadding = getVerticalPadding(width);\n  const dotOffsetX = getDotOffsetX(width, trackNumber);\n  const infoHeight = getInfoHeight(width);\n  const fontSize = \"1.1vw\";\n\n  album\n    .append(\"svg:image\")\n    .attr(\"width\", coverSize)\n    .attr(\"height\", coverSize)\n    .attr(\"x\", trackNumber * coverSize)\n    .attr(\"y\", 0)\n    .style(\"stroke\", \"white\")\n    .attr(\"xlink:href\", imageUrl);\n\n  // Draw country rectangle\n  album\n    .append(\"rect\")\n    .attr(\"width\", coverSize)\n    .attr(\"height\", infoHeight)\n    .attr(\"x\", trackNumber * coverSize)\n    .attr(\"y\", coverSize + verticalPadding)\n    .style(\"fill\", trackColor);\n\n  // Draw country text\n  const countryText = album\n    .append(\"text\")\n    .attr(\"id\", \"countryText\" + trackNumber)\n    .attr(\"x\", trackNumber * coverSize + horizontalPadding)\n    .attr(\"y\", coverSize + verticalPadding + infoHeight / 2)\n    .attr(\"dy\", \"0.35em\")\n    .style(\"font-size\", fontSize)\n    .text(country);\n\n  // Trucate text larger than coverSize\n  const countryTextId = \"countryText\" + trackNumber;\n  function wrap(textElement, textId) {\n    let textLength = document.getElementById(textId).getBBox().width;\n    let text = textElement.text();\n\n    while (textLength > coverSize - horizontalPadding * 2 && text.length > 0) {\n      text = text.slice(0, -1);\n      textElement.text(text + \"...\");\n      textLength = document.getElementById(textId).getBBox().width;\n    }\n  }\n  wrap(countryText, countryTextId);\n\n  // Draw date point\n  album\n    .append(\"circle\")\n    .attr(\"cx\", dotOffsetX)\n    .attr(\"cy\", coverSize + verticalPadding + infoHeight * 2)\n    .attr(\"r\", DOT_RADIUS)\n    .style(\"fill\", trackColor);\n\n  // Draw date text\n  album\n    .append(\"text\")\n    .attr(\"x\", trackNumber * coverSize + horizontalPadding)\n    .attr(\"y\", coverSize + verticalPadding + infoHeight * 1.5)\n    .attr(\"dy\", \"0.35em\")\n    .style(\"font-size\", fontSize)\n    .style(\"fill\", trackColor)\n    .text(year);\n\n  return album;\n}\n","import * as d3 from \"d3\";\nimport { getDotOffsetX } from \"./dimensions\";\n\nexport default function createRefLine(\n  parent,\n  windowWidth,\n  cx,\n  cy,\n  trackNumber,\n  trackColor\n) {\n  const x1 = getDotOffsetX(windowWidth, trackNumber);\n  const y1 = 0;\n  const x2 = cx;\n  const y2 = cy;\n  const h = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n  const a = h / 10;\n  const alfa = Math.acos((y2 - y1) / h);\n  const curveCoords = [\n    {\n      x: x1,\n      y: y1\n    },\n    {\n      x: x1 + (x2 - x1) / 2 + a * Math.cos(Math.PI - alfa),\n      y: y1 + (y2 - y1) / 2 + a * Math.sin(Math.PI - alfa)\n    },\n    { x: x2, y: y2 }\n  ];\n\n  const line = d3\n    .line()\n    .x(d => d.x)\n    .y(d => d.y)\n    .curve(d3.curveBasis);\n\n  const refLine = parent\n    .append(\"path\")\n    .datum(curveCoords)\n    .attr(\"d\", line)\n    .style(\"stroke\", trackColor)\n    .style(\"stroke-dasharray\", \"2, 3\")\n    .style(\"fill\", \"none\")\n    .style(\"stroke-width\", 2);\n\n  return refLine;\n}\n","import * as d3 from \"d3\";\n\nexport default function createWave(\n  parent,\n  screenWidth,\n  cx,\n  cy,\n  trackColor,\n  trackVolume\n) {\n  const firstRadius = Math.floor((screenWidth / 30) * trackVolume);\n  const lastRadius = 150;\n  const radius = d3.range(firstRadius, lastRadius);\n  const duration = 20;\n\n  const wave = parent\n    .append(\"circle\")\n    .attr(\"cx\", cx)\n    .attr(\"cy\", cy)\n    .attr(\"r\", 0)\n    .style(\"fill\", \"none\")\n    .style(\"stroke\", trackColor);\n\n  radius.forEach((r, i) => {\n    const initialWidth = 2;\n    const strokeWidth = initialWidth - (initialWidth * r) / lastRadius;\n    wave\n      .transition()\n      .duration(duration)\n      .delay(i * duration)\n      .attr(\"r\", r)\n      .style(\"stroke-width\", strokeWidth)\n      .on(\"end\", (d, i, nodes) => {\n        if (r === lastRadius - 1) nodes[i].remove();\n      });\n  });\n\n  return wave;\n}\n","import * as d3 from \"d3\";\nimport * as chroma from \"chroma-js\";\n\nexport function createImprint(point, color) {\n  d3.selectAll(\".countries\").each(polygon => {\n    const inside = d3.geoContains(polygon, point);\n    if (inside) {\n      const base = d3.select(`#country${polygon.id}`).style(\"fill\");\n      d3.select(`#country${polygon.id}`)\n        // .style(\"fill\", chroma.blend(base, color, \"lighten\").hex()); // applies trackColor\n        .style(\"fill\", chroma(base).brighten(0.2)); // gray to white. Step: 0.2\n    }\n  });\n}\n","import { getAlbumHeight } from \"./dimensions\";\n\nexport function createLastSampleInfo(\n  parent,\n  screenWidth,\n  screenHeight,\n  { title, artist, album, trackColor }\n) {\n  // Clear\n  parent.select(\"#lastSampleInfoGroup\").remove();\n  const lastSampleInfo = parent.append(\"g\").attr(\"id\", \"lastSampleInfoGroup\");\n  const rectSize = screenWidth / 20;\n  const albumsHeight = getAlbumHeight(screenWidth);\n  const horizontalPadding = screenWidth / 190;\n  const verticalPadding = rectSize / 3;\n  const x = screenWidth - rectSize;\n  const y = screenHeight - albumsHeight - rectSize;\n  const dy = \"-0.35em\";\n  const fontSize = \"1.1vw\";\n\n  lastSampleInfo\n    .append(\"rect\")\n    .attr(\"width\", rectSize)\n    .attr(\"height\", rectSize)\n    .attr(\"x\", x)\n    .attr(\"y\", y)\n    .style(\"fill\", trackColor);\n\n  lastSampleInfo\n    .append(\"text\")\n    .attr(\"x\", x + horizontalPadding)\n    .attr(\"y\", y + verticalPadding * 1)\n    .attr(\"dy\", dy)\n    .attr(\"font-size\", fontSize)\n    .text(\"title\");\n\n  lastSampleInfo\n    .append(\"text\")\n    .attr(\"x\", x - horizontalPadding)\n    .attr(\"y\", y + verticalPadding * 1)\n    .attr(\"dy\", dy)\n    .attr(\"font-size\", fontSize)\n    .style(\"text-anchor\", \"end\")\n    .style(\"fill\", \"#e6e6e6\")\n    .text(title);\n\n  lastSampleInfo\n    .append(\"text\")\n    .attr(\"x\", x + horizontalPadding)\n    .attr(\"y\", y + verticalPadding * 2)\n    .attr(\"dy\", dy)\n    .attr(\"font-size\", fontSize)\n    .text(\"artist\");\n\n  lastSampleInfo\n    .append(\"text\")\n    .attr(\"x\", x - horizontalPadding)\n    .attr(\"y\", y + verticalPadding * 2)\n    .attr(\"dy\", dy)\n    .attr(\"font-size\", fontSize)\n    .style(\"text-anchor\", \"end\")\n    .style(\"fill\", \"#e6e6e6\")\n    .text(artist);\n\n  lastSampleInfo\n    .append(\"text\")\n    .attr(\"x\", x + horizontalPadding)\n    .attr(\"y\", y + verticalPadding * 3)\n    .attr(\"dy\", dy)\n    .attr(\"font-size\", fontSize)\n    .text(\"album\");\n\n  lastSampleInfo\n    .append(\"text\")\n    .attr(\"x\", x - horizontalPadding)\n    .attr(\"y\", y + verticalPadding * 3)\n    .attr(\"dy\", dy)\n    .attr(\"font-size\", fontSize)\n    .style(\"text-anchor\", \"end\")\n    .style(\"fill\", \"#e6e6e6\")\n    .text(album);\n\n  return lastSampleInfo;\n}\n","import { select } from \"d3\";\n\nexport const RATIOS = {\n  sixteenNinths: 16 / 9,\n  sixteenTenths: 16 / 10\n};\nconst RATIO = RATIOS.sixteenTenths;\n\n/**\n * A display encapsulates drawing mechanics\n *\n * @param {*} el\n */\n\nexport default class Display {\n  constructor(el) {\n    this.el = el;\n    this.clear();\n  }\n\n  setVisible(isVisible) {\n    this.el.style.display = isVisible ? \"block\" : \"none\";\n  }\n\n  clear() {\n    const d3 = select(this.el);\n    d3.selectAll(\"*\").remove();\n\n    this.dimensions = calculateDimensions(this.el);\n    this.svg = d3\n      .append(\"svg\")\n      .attr(\"width\", this.dimensions.width)\n      .attr(\"height\", this.dimensions.height);\n    return this.svg;\n  }\n}\n\nfunction calculateDimensions(el) {\n  const w = el.offsetWidth;\n  const h = el.offsetHeight;\n  const realAspectRatio = w / h;\n\n  const width = realAspectRatio < RATIO ? w : h * RATIO;\n  const height = realAspectRatio < RATIO ? w / RATIO : h;\n  const scale = RATIO === RATIOS.sixteenTenths ? width / 5.9 : width / 6.5;\n  return { width, height, scale };\n}\n\nexport function getWindowSize(ratio) {\n  return getFixedSize(window.innerWidth, window.innerHeight, ratio);\n}\n\nfunction getFixedSize(width, height, ratio) {\n  const realAspectRatio = width / height;\n\n  const screenWidth = realAspectRatio < ratio ? width : height * ratio;\n  const screenHeight = realAspectRatio < ratio ? width / ratio : height;\n\n  return { screenWidth, screenHeight };\n}\n","import Visuals from \"./visuals\";\nimport Display from \"./display\";\nimport Resources from \"../audioset/resources\";\n\nexport default { init };\n\n// TODO: move all this into effects\nexport function init(el) {\n  if (!el) el = createElement();\n  const display = new Display(el);\n  display.setVisible(false);\n  let current;\n\n  return {\n    setAudioset(audioset) {\n      if (audioset) current = createVisuals(audioset, display);\n      else current = removeVisuals(current, display);\n    },\n    startClip(clipId) {\n      current.show(clipId);\n    },\n    stopClip(clipId) {\n      current.hide(clipId);\n    },\n    setVisible(isVisible) {\n      display.setVisible(isVisible);\n      if (isVisible && current) current.render();\n    }\n  };\n}\n\nfunction createElement() {\n  const el = document.createElement(\"div\");\n  el.setAttribute(\"class\", \"visuals\");\n  document.body.appendChild(el);\n  return el;\n}\n\nfunction removeVisuals(visuals, display) {\n  display.setVisible(false);\n  display.clear();\n  return null;\n}\n\nfunction createVisuals(audioset, display) {\n  Resources.loadResources(audioset, \"covers\");\n  const visuals = new Visuals(audioset, display);\n  visuals.render();\n  fetch(audioset.visuals.geoMapUrl)\n    .then(response => response.json())\n    .then(data => visuals.setGeodata(data));\n\n  return visuals;\n}\n","import {\n  SYNC_PLAYBACK,\n  START_AUDIO_CLIP,\n  STOP_AUDIO_CLIP\n} from \"../../playback/actions\";\nimport { INIT_SIDE_EFFECTS, SET_WINDOW_SIZE } from \"../model\";\n\nimport Visuals from \"../../visuals\";\n\nlet visuals;\n\nconst isVisible = state => state.display.type === \"desktop\";\n\nexport default function effects(action, { getState }) {\n  switch (action.type) {\n    case INIT_SIDE_EFFECTS:\n      visuals = Visuals.init();\n      break;\n\n    case SET_WINDOW_SIZE:\n      visuals.setVisible(isVisible(getState()));\n      break;\n\n    case SYNC_PLAYBACK:\n      visuals.setAudioset(action.playback.audioset);\n      visuals.setVisible(isVisible(getState()));\n      break;\n\n    case START_AUDIO_CLIP:\n      visuals.startClip(action.clipId);\n      break;\n\n    case STOP_AUDIO_CLIP:\n      visuals.stopClip(action.clipId);\n      break;\n\n    default:\n      break;\n  }\n}\n","import audio from \"./audio.effects\";\nimport audioset from \"./audioset.effects\";\nimport fullscreen from \"./fullscreen.effects\";\nimport keyboard from \"./keyboard.effects\";\nimport room from \"./room.effects\";\nimport visuals from \"./visuals.effects\";\n\nexport default [room, audio, visuals, audioset, fullscreen, keyboard];\n","import { setAudioset } from \"../../playback/actions\";\nimport { LOAD_AUDIOSET, setAudiosetIndex, INIT_SIDE_EFFECTS } from \"../model\";\nimport { fetchAudioset, fetchIndex } from \"../../audioset\";\n\nexport default function effects(action, { dispatch }) {\n  switch (action.type) {\n    case INIT_SIDE_EFFECTS:\n      fetchIndex().then(index => dispatch(setAudiosetIndex(index)));\n      break;\n    case LOAD_AUDIOSET:\n      fetchAudioset(action.id).then(audioset =>\n        dispatch(setAudioset(audioset))\n      );\n      break;\n    default:\n      break;\n  }\n}\n","import { init } from \"../../audioset/inputs\";\n\nexport default function(action, { dispatch, getState }) {\n  switch (action.type) {\n    case \"INIT_SIDE_EFFECTS\":\n      init(dispatch, getState);\n      break;\n    default:\n      return;\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport { setAudioset } from \"./playback/actions\";\nimport App from \"./ui/App\";\nimport Modal from \"react-modal\";\nimport createStore from \"./store/createStore\";\n\n// const ENV = process.env.NODE_ENV;\n// const WEBSOCKETS_URL = \"http://localhost:4000\";\nconst store = createStore();\n\n// trigger the current audioset action\nconst state = store.getState();\nconst { audioset } = state.playback;\nif (state.playback.audioset) {\n  store.dispatch(setAudioset(audioset));\n}\n\nconst element = document.getElementById(\"app\");\nModal.setAppElement(element);\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  element\n);\n","import { createStore, compose, applyMiddleware } from \"redux\";\n// import thunk from \"redux-thunk\";\nimport { throttle } from \"lodash\";\nimport { loadState, saveState } from \"../browser/localStorage\";\n\nimport reducer, { INIT_SIDE_EFFECTS } from \"./model\";\nimport effects from \"./effects\";\n\n/**\n * Create an store\n */\nexport default function() {\n  const initialState = loadState();\n\n  const fxLen = effects.length;\n  const effectsMiddleware = store => next => action => {\n    // state is updated first!\n    next(action);\n    for (let i = 0; i < fxLen; i++) effects[i](action, store);\n  };\n\n  const devTools = window.__REDUX_DEVTOOLS_EXTENSION__\n    ? window.__REDUX_DEVTOOLS_EXTENSION__()\n    : f => f;\n  const enhancer = compose(\n    applyMiddleware(effectsMiddleware),\n    devTools\n  );\n\n  const store = createStore(reducer, initialState, enhancer);\n  store.dispatch({ type: INIT_SIDE_EFFECTS });\n\n  store.subscribe(\n    throttle(() => saveState(getStateToSave(store.getState())), 1000)\n  );\n  return store;\n}\n\nfunction getStateToSave({ playback, sync }) {\n  return { playback, sync };\n}\n"],"sourceRoot":""}