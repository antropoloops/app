(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{47:function(t,e,n){t.exports=n(69)},57:function(t,e,n){},69:function(t,e,n){"use strict";n.r(e);var r=n(2),a=n.n(r),o=n(11),i=n.n(o),s=n(9),c="[playback] ",l=function(t){return c+t},u=l("SYNC_PLAYBACK"),d=function(t){return{type:u,playback:t}},p=function(t){return{type:u,playback:{audioset:t}}},f=l("PRESS_PAD"),h=function(t){return{type:f,clipId:t}},m=l("RELEASE_PAD"),v=function(t){return{type:m,clipId:t}},y=l("START_AUDIO_CLIP"),b=l("STOP_AUDIO_CLIP"),g=l("SET_AUDIO_STARTED"),k=l("SET_AUDIO_STOPPED"),E=l("AUDIO_STOP_ALL"),O=l("CHANGE_TRACK_VOLUME"),C=n(10),S=n(5),w=n.n(S),x={stop:"M6 6h12v12H6z",fly:"M17.218,2.268L2.477,8.388C2.13,8.535,2.164,9.05,2.542,9.134L9.33,10.67l1.535,6.787c0.083,0.377,0.602,0.415,0.745,0.065l6.123-14.74C17.866,2.46,17.539,2.134,17.218,2.268 M3.92,8.641l11.772-4.89L9.535,9.909L3.92,8.641z M11.358,16.078l-1.268-5.613l6.157-6.157L11.358,16.078z",mute:"M18.084,11.639c0.168,0.169,0.168,0.442,0,0.611c-0.084,0.084-0.195,0.127-0.306,0.127c-0.111,0-0.221-0.043-0.306-0.127l-1.639-1.639l-1.639,1.639c-0.084,0.084-0.195,0.127-0.306,0.127c-0.111,0-0.222-0.043-0.307-0.127c-0.168-0.169-0.168-0.442,0-0.611L15.223,10l-1.64-1.639c-0.168-0.168-0.168-0.442,0-0.61c0.17-0.169,0.442-0.169,0.612,0l1.639,1.639l1.639-1.639c0.169-0.169,0.442-0.169,0.611,0c0.168,0.168,0.168,0.442,0,0.61L16.445,10L18.084,11.639z M12.161,2.654v14.691c0,0.175-0.105,0.333-0.267,0.4c-0.054,0.021-0.109,0.032-0.166,0.032c-0.111,0-0.223-0.043-0.305-0.127l-3.979-3.979H2.222c-0.237,0-0.432-0.194-0.432-0.432V6.759c0-0.237,0.195-0.432,0.432-0.432h5.222l3.979-3.978c0.123-0.125,0.309-0.163,0.471-0.095C12.056,2.322,12.161,2.479,12.161,2.654 M7.192,7.192H2.654v5.617h4.538V7.192z M11.296,3.698l-3.24,3.241v6.123l3.24,3.24V3.698z",cinema:"M18.175,4.142H1.951C1.703,4.142,1.5,4.344,1.5,4.592v10.816c0,0.247,0.203,0.45,0.451,0.45h16.224c0.247,0,0.45-0.203,0.45-0.45V4.592C18.625,4.344,18.422,4.142,18.175,4.142 M4.655,14.957H2.401v-1.803h2.253V14.957zM4.655,12.254H2.401v-1.803h2.253V12.254z M4.655,9.549H2.401V7.747h2.253V9.549z M4.655,6.846H2.401V5.043h2.253V6.846zM14.569,14.957H5.556V5.043h9.013V14.957z M17.724,14.957h-2.253v-1.803h2.253V14.957z M17.724,12.254h-2.253v-1.803h2.253V12.254zM17.724,9.549h-2.253V7.747h2.253V9.549z M17.724,6.846h-2.253V5.043h2.253V6.846z",controls:"M6.176,7.241V6.78c0-0.221-0.181-0.402-0.402-0.402c-0.221,0-0.403,0.181-0.403,0.402v0.461C4.79,7.416,4.365,7.955,4.365,8.591c0,0.636,0.424,1.175,1.006,1.35v3.278c0,0.222,0.182,0.402,0.403,0.402c0.222,0,0.402-0.181,0.402-0.402V9.941c0.582-0.175,1.006-0.714,1.006-1.35C7.183,7.955,6.758,7.416,6.176,7.241 M5.774,9.195c-0.332,0-0.604-0.272-0.604-0.604c0-0.332,0.272-0.604,0.604-0.604c0.332,0,0.604,0.272,0.604,0.604C6.377,8.923,6.105,9.195,5.774,9.195 M10.402,10.058V6.78c0-0.221-0.181-0.402-0.402-0.402c-0.222,0-0.402,0.181-0.402,0.402v3.278c-0.582,0.175-1.006,0.714-1.006,1.35c0,0.637,0.424,1.175,1.006,1.351v0.461c0,0.222,0.181,0.402,0.402,0.402c0.221,0,0.402-0.181,0.402-0.402v-0.461c0.582-0.176,1.006-0.714,1.006-1.351C11.408,10.772,10.984,10.233,10.402,10.058M10,12.013c-0.333,0-0.604-0.272-0.604-0.604S9.667,10.805,10,10.805c0.332,0,0.604,0.271,0.604,0.604S10.332,12.013,10,12.013M14.629,8.448V6.78c0-0.221-0.182-0.402-0.403-0.402c-0.221,0-0.402,0.181-0.402,0.402v1.668c-0.581,0.175-1.006,0.714-1.006,1.35c0,0.636,0.425,1.176,1.006,1.351v2.07c0,0.222,0.182,0.402,0.402,0.402c0.222,0,0.403-0.181,0.403-0.402v-2.07c0.581-0.175,1.006-0.715,1.006-1.351C15.635,9.163,15.21,8.624,14.629,8.448 M14.226,10.402c-0.331,0-0.604-0.272-0.604-0.604c0-0.332,0.272-0.604,0.604-0.604c0.332,0,0.604,0.272,0.604,0.604C14.83,10.13,14.558,10.402,14.226,10.402 M17.647,3.962H2.353c-0.221,0-0.402,0.181-0.402,0.402v11.27c0,0.222,0.181,0.402,0.402,0.402h15.295c0.222,0,0.402-0.181,0.402-0.402V4.365C18.05,4.144,17.869,3.962,17.647,3.962 M17.245,15.232H2.755V4.768h14.49V15.232z",stop2:"M10 0c-5.523 0-10 4.477-10 10s4.477 10 10 10 10-4.477 10-10-4.477-10-10-10zM10 18.125c-4.487 0-8.125-3.638-8.125-8.125s3.638-8.125 8.125-8.125 8.125 3.638 8.125 8.125-3.638 8.125-8.125 8.125zM6.25 6.25h7.5v7.5h-7.5z",fullscreen:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z",keyboard:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z",volumeUp:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z",volumeDown:"M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z",volumeOff:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"},I=function(t){var e=t.icon,n=t.color,r=t.onClick;return a.a.createElement("svg",{fill:n||"#CCC",onClick:r,height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:x[e]||e}))},j=w()("button")({color:"black",display:"block",background:"white",font:"inherit",padding:"0 1em",":hover":{textDecoration:"underline"}}),A=w()("button")({color:"white",cursor:"pointer",display:"block",background:"none",font:"inherit",border:0,":hover":{textDecoration:"underline"}}),M=function(t){return t?"white":"gray"},z=w()("div")(),T=w()("div")(),R=w()("div")({marginTop:"3px",flexGrow:1,textAlign:"center"}),P=w()("div")({display:"flex",flexDirection:"row",backgroundColor:"black",padding:"2px 10px"}),V=n(6),_=n(17),L=null;var H={isPlaying:!1,status:"STOP",startedAt:null};var N=function(t,e){return t.tracks.reduce(function(t,n){return t[n.id]=e,t},{})};function D(t){return t?{playing:N(t,0),volumes:N(t,75)}:{playing:{},volumes:{}}}var U=Object(C.c)({audioset:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case u:return e.playback.audioset;default:return t}},audio:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case g:return Object(V.a)({},t,{status:"PLAYING",startedAt:e.time});case k:return Object(V.a)({},t,{status:"STOP",startedAt:null});case y:case b:return Object(V.a)({},t,{status:Object(V.a)({},t.status,Object(_.a)({},e.clipId,e.status))});case E:return Object(V.a)({},t,{status:{}});default:return t}},tracks:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D(),e=arguments.length>1?arguments[1]:void 0;switch(e.type){case u:return D(e.playback.audioset);case y:case b:return function(t,e,n){var r=n.isPlaying?1:-1;return Object(V.a)({},t,{playing:Object(V.a)({},t.playing,Object(_.a)({},e,t.playing[e]+r))})}(t,e.trackId,e.status);case O:return function(t,e,n){return Object(V.a)({},t,{volumes:Object(V.a)({},t.volumes,Object(_.a)({},e,n))})}(t,e.trackId,e.value);default:return t}}}),G="INIT_SIDE_EFFECTS",B=function(t){return"/session/"+t},F=B("SET_AUDIOSET_INDEX"),J=B("LOAD_AUDIOSET"),q=B("TOGGLE_IS_CONTROL"),W=function(t){return{type:F,index:t}},K={audiosetIndex:null,isControl:!1};var X={user:null,room:null,roomList:[]},Y=function(t){return"/sync/"+t},Q=Y("SET_LOGGED_IN"),Z=Y("CREATE_ROOM_REQUEST"),$=Y("SET_CURRENT_ROOM"),tt=Y("SET_ROOM_LIST"),et=Y("REQUEST_ROOM"),nt=function(t){return{type:Q,user:t}},rt=function(t){return{type:$,room:t}},at=function(t){return{type:tt,roomList:t}};var ot={session:!0,pads:!1,tracks:!1,help:!1,fullscreen:!1},it=function(t){return"/display/"+t},st=it("SHOW_SESSION"),ct=it("TOGGLE_TRACKS"),lt=it("TOGGLE_PADS"),ut=it("SHOW_HELP"),dt=it("HIDE_HELP"),pt=it("SHOW_FULLSCREEN"),ft=it("SET_FULLSCREEN"),ht=it("SET_WINDOW_SIZE"),mt=function(t,e){return{type:ht,size:{width:t,height:e}}},vt=function(){return{type:st}},yt=function(){return{type:dt}},bt=function(t){return{type:ft,isFullscreen:t}};var gt=Object(C.c)({playback:U,session:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case F:return Object(V.a)({},t,{audiosetIndex:e.index});case q:return Object(V.a)({},t,{isControl:!t.isControl});default:return t}},display:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case ht:return Object(V.a)({},t,{type:e.size.width<700?"mobile":"desktop"});case u:case st:return Object(V.a)({},t,{session:!t.session});case ut:return Object(V.a)({},t,{help:!0});case dt:return Object(V.a)({},t,{help:!1});case lt:return Object(V.a)({},t,{pads:!t.pads});case ct:return Object(V.a)({},t,{tracks:!t.tracks});case ft:return Object(V.a)({},t,{fullscreen:e.isFullscreen});default:return t}},sync:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case Q:return Object(V.a)({},t,{user:e.user,room:t.room&&t.room.id===e.user.roomId?t.room:null});case $:return Object(V.a)({},t,{room:e.room});case tt:return Object(V.a)({},t,{roomList:e.roomList});default:return t}}}),kt={toggleSession:vt,showHelp:function(){return{type:ut}},hideHelp:yt,togglePads:function(){return{type:lt}},toggleTracks:function(){return{type:ct}},showFullscreen:function(){return{type:pt}},toggleIsControl:function(){return{type:q}}},Et=Object(s.b)(function(t){return{audioset:t.playback.audioset,isControl:t.session.isControl,display:t.display,isDesktop:"desktop"===t.display.type}},function(t){return Object(C.b)(kt,t)})(function(t){var e=t.audioset,n=t.isControl,r=t.isDesktop,o=t.display,i=t.toggleSession,s=t.showHelp,c=t.togglePads,l=t.toggleTracks,u=t.toggleIsControl,d=t.showFullscreen;return a.a.createElement(P,null,a.a.createElement("div",null,r&&a.a.createElement(I,{icon:"fly",onClick:s})),a.a.createElement(R,{id:"Connection",onClick:i},e.meta.title),r&&a.a.createElement(z,{id:"Transport"},a.a.createElement(I,{icon:"stop"}),a.a.createElement(I,{icon:"mute"})),r&&a.a.createElement(T,null,a.a.createElement(I,{icon:"mute",onClick:u,color:n?"gray":"green"}),a.a.createElement(I,{icon:"controls",color:M(o.pads),onClick:c}),a.a.createElement(I,{icon:"controls",color:M(o.tracks),onClick:l}),a.a.createElement(I,{icon:"cinema",color:M(o.fullscreen),onClick:d})))}),Ot=function(t){var e=t.audiosetIndex,n=t.rooms,r=t.onOpenAudioset,o=t.onJoinRoom;return a.a.createElement("div",null,a.a.createElement("h2",null,"Empieza una nueva remezcla"),e.map(function(t){return a.a.createElement(A,{key:t.id,onClick:function(){return r(t.id)}},t.meta.title,": ",t.meta.description)}),a.a.createElement("h2",null,"Con\xe9ctate a una en marcha"),n.length?n.map(function(t){return a.a.createElement(A,{key:t.id,onClick:function(){return o(t)}},t.name)}):"No hay otras sesiones activas en este momento.")},Ct=function(t){var e=t.audioset,n=t.onCloseAudioset,r=t.room,o=t.onRequestRoom;return a.a.createElement("div",{className:"Session"},a.a.createElement("h1",null,e.meta.title),a.a.createElement("p",null,e.meta.description),r?a.a.createElement("h2",null,"Room: ",r.name):a.a.createElement(j,{onClick:o},"Request room"),a.a.createElement(j,{onClick:n},"Cerrar audioset"))},St=w()("div")({display:"flex",flexDirection:"column"}),wt=w()(St)({backgroundColor:"black",padding:"1em"});wt.Layout=St,wt.Section=wt.Header=wt.Footer=w()("div")({backgroundColor:"black"}),wt.Content=wt.Main=w()("div")({flexGrow:1});var xt=wt,It=Object(s.b)(function(t){return{audioset:t.playback.audioset,audiosetIndex:t.session.audiosetIndex,room:t.sync.room,rooms:t.sync.roomList}},function(t){return{openAudioset:function(e){return t({type:J,id:e})},closeAudioset:function(){return t(p(null))},requestRoom:function(){return t({type:Z})},joinRoom:function(e){return t(function(t){return{type:et,room:t}}(e))}}})(function(t){var e=t.audioset,n=t.audiosetIndex,r=t.openAudioset,o=t.closeAudioset,i=t.room,s=t.rooms,c=t.requestRoom,l=t.joinRoom;return a.a.createElement(xt,{id:"Session"},a.a.createElement(xt.Header,null,a.a.createElement("h1",null,"Bienvenidx a Antropoloops")),a.a.createElement(xt.Content,null,n&&!e&&a.a.createElement(Ot,{audiosetIndex:n,onOpenAudioset:r,rooms:s,onJoinRoom:l}),e&&a.a.createElement(Ct,{audioset:e,room:i,onRequestRoom:c,onCloseAudioset:o})))}),jt=n(13),At=n(14),Mt=n(44),zt=n(36),Tt=n(45),Rt=(n(57),function(t){function e(t){var n;return Object(jt.a)(this,e),(n=Object(Mt.a)(this,Object(zt.a)(e).call(this,t))).touched=!1,n}return Object(Tt.a)(e,t),Object(At.a)(e,[{key:"handlePress",value:function(t){if(t)this.touched=!0;else if(!0===this.touched)return void(this.touched=!1);var e=!this.props.pressed;this.props[e?"onPress":"onRelease"](this.props.name)}},{key:"render",value:function(){var t=this,e=this.props,n=e.color,r=e.pressed,o=e.touch,i=e.image,s=e.name;return a.a.createElement("button",{className:"Pad ".concat(r?"pressed":""),style:{borderColor:n},onTouchStart:o?function(){return t.handlePress(!0)}:void 0,onMouseDown:function(){return t.handlePress(!1)}},i?a.a.createElement("img",{src:i,alt:s}):"")}}]),e}(a.a.Component)),Pt=function(t){var e=t.track,n=t.status,r=t.onPadPressed,o=t.onPadReleased;return a.a.createElement("div",null,e.clipIds.map(function(t){return a.a.createElement(Rt,{key:t,name:t,pressed:n[t]&&n[t].isPlaying,color:e.color,onPress:r,onRelease:o})}))},Vt=w()(function(t){var e=t.audioset,n=t.status,r=t.className,o=t.onPadPressed,i=t.onPadReleased;return a.a.createElement("div",{className:r,id:"Pads"},e.tracks.map(function(t){return a.a.createElement(Pt,{key:t.name,track:t,status:n,onPadPressed:o,onPadReleased:i})}))})({backgroundColor:"black",width:"100%",padding:"1em",minHeight:"100%"}),_t=Object(s.b)(function(t){return{audioset:t.playback.audioset,status:t.playback.audio.status}},function(t){return{onPadPressed:function(e){return t(h(e))},onPadReleased:function(e){return t(v(e))}}})(Vt),Lt=n(26),Ht=n.n(Lt),Nt=n(0),Dt=n.n(Nt),Ut=w()(function(t){var e=t.onPress,n=t.onRelease,r=t.className,o=t.children;return a.a.createElement("button",{className:r,onMouseDown:e,onMouseUp:n},o)})(function(t){return{border:"2px solid ".concat(t.color),color:t.color,backgroundColor:t.pressed?t.color:"black",marginRight:"0.5em",padding:"1px 3px","&:hover":{backgroundColor:t.color,color:"black"}}});Ut.propTypes={color:Dt.a.string};var Gt=Ut,Bt=w()("div")(function(t){return{color:t.color,borderTop:"2px solid ".concat(t.active?t.color:"black"),"> h2":{marginTop:"5px"},marginBottom:"1em"}}),Ft=Ht()({padding:"1em",backgroundColor:"black"}),Jt=function(t){var e=t.audioset,n=t.volumes,r=t.playing,o=t.status,i=t.onVolumeChanged,s=t.onPress,c=t.onRelease;return a.a.createElement("div",{className:Ft},a.a.createElement("h2",null,"Tracks"),e.tracks.map(function(t){return a.a.createElement(Bt,{key:t.id,active:r[t.id],color:t.color},a.a.createElement("h2",null,t.id),a.a.createElement("div",null,t.clipIds.map(function(t){return a.a.createElement(Gt,{key:t,pressed:o[t]&&o[t].isPlaying,onPress:function(){return s(t)},onRelease:function(){return c(t)},color:e.clips[t].display.color},t)})),a.a.createElement("input",{type:"range",min:"0",max:"100",value:n[t.id],onChange:function(e){return i(t.id,e.target.value)}}))}))},qt=Object(s.b)(function(t){return{audioset:t.playback.audioset,status:t.playback.audio.status,volumes:t.playback.tracks.volumes,playing:t.playback.tracks.playing}},function(t){return{onVolumeChanged:function(e,n){return t({type:O,trackId:e,volume:n})},onPress:function(e){return t(h(e))},onRelease:function(e){return t(v(e))}}})(Jt),Wt=[];function Kt(t,e){return t.startsWith("audioset://")&&console.log("save",t,e),Wt[t]=e,e}function Xt(t){return Wt[t]}function Yt(t){return void 0!==Wt[t]}function Qt(t,e,n){var r="audioset://".concat(t.id,"/").concat(e);return Yt(r)?Xt(r):Kt(r,n())}function Zt(t,e){return Yt(t)?Promise.resolve(Xt(t)):fetch(t).then(e).then(function(e){return Kt(t,e)})}function $t(t){return Qt(t,"keyboardMap",function(){return function(t){if(!t)return{};var e=t.defaults,n=t.keyMap;return Object.keys(n).reduce(function(t,r){var a=Object(V.a)({},e,n[r]);return a.key=r,t[r]=a,t[r.toUpperCase()]=a,t[a.clipId]=a,t},{})}(t.keyboard)})}var te=w()(Gt)(function(t){return{marginRight:"0.5em",padding:"1px 3px"}}),ee=w()(function(t){var e=t.audioset,n=t.status,r=t.className,o=t.onPress,i=t.onRelease,s=$t(e);return a.a.createElement("div",{className:r,id:"Keyboard"},e.tracks.map(function(t){return t.clipIds.map(function(e){return a.a.createElement(te,{key:e,pressed:n[e]&&n[e].isPlaying,color:t.color,onPress:function(){return o(e)},onRelease:function(){return i(e)}},s[e]?s[e].key.toUpperCase():"-")})}))})({backgroundColor:"black",textAlign:"center",padding:"2px 10px 4px 10px"}),ne=Object(s.b)(function(t){return{audioset:t.playback.audioset,status:t.playback.audio.status}},function(t){return{onPress:function(e){return t(h(e))},onRelease:function(e){return t(v(e))}}})(ee),re=n(22),ae=n.n(re),oe=n(46),ie=[{target:"#Connection",content:"Has creado una sesi\xf3n. Puedes cambiarla o conectar con otros dispositivos aqu\xed",placement:"bottom",disableBeacon:!0},{target:"#Keyboard",content:"Usa el teclado para lanzar los sonidos. Tambi\xe9n puedes usar MIDI o un MakeyMakey!",placement:"top",disableBeacon:!0},{target:"#Transport",content:"Ponlo en pantalla completa o abre los controles",disableBeacon:!0}],se={back:"Anterior",close:"Cerrar",last:"Ok, lo he pillado",next:"Siguiente",skip:"Salir"},ce={options:{arrowColor:"#111",backgroundColor:"#111",beaconSize:70,overlayColor:"rgba(255, 255, 255, 0.5)",primaryColor:"#000",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"white",width:void 0,zIndex:100},tooltip:{fontSize:14,fontFamily:"system"},buttonSkip:{fontSize:12}},le=function(t){var e=t.run,n=t.onStop;return a.a.createElement(oe.a,{callback:function(t){return"reset"===t.action&&n()},run:e,locale:se,styles:ce,showProgress:!1,showSkipButton:!0,continuous:!0,steps:ie})},ue=function(t){var e=t.audioset,n=t.display;return a.a.createElement(fe,null,e&&a.a.createElement(Et,null),a.a.createElement(he,null,n.session?a.a.createElement(It,null):a.a.createElement(_t,null)))},de=function(t){var e=t.audioset,n=t.display,r=t.toggleSession,o=t.hideHelp,i=!n.fullscreen;return a.a.createElement(a.a.Fragment,null,e&&a.a.createElement(fe,{className:"App"},a.a.createElement(le,{run:n.help,onStop:o}),i&&a.a.createElement(Et,null),a.a.createElement(he,null,i&&n.pads&&a.a.createElement(_t,null),a.a.createElement(me,null),i&&n.tracks&&a.a.createElement(qt,null)),i&&a.a.createElement(ne,null)),a.a.createElement(ae.a,{isOpen:!e||n.session,shouldCloseOnOverlayClick:!0,onRequestClose:r,style:pe},a.a.createElement(It,null)))},pe={overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:900},content:{position:"fixed",maxHeight:"calc(100% - 100px)",top:"50%",left:"50%",transform:"translate(-50%, -50%)",border:"",background:"black",borderRadius:0,zIndex:1e3}},fe=w()("div")({display:"flex",flexDirection:"column",minHeight:"100vh"}),he=w()("div")({display:"flex",flexGrow:1,flexDirection:"row",height:"100%",minHeight:"100%",maxHeight:"100%",overflow:"hidden"}),me=w()("div")({flexGrow:1}),ve={toggleSession:vt,hideHelp:yt},ye=Object(s.b)(function(t){return{audioset:t.playback.audioset,display:t.display}},function(t){return Object(C.b)(ve,t)})(function(t){return"mobile"===t.display.type?a.a.createElement(ue,t):a.a.createElement(de,t)}),be=n(23),ge="atpls/session";var ke=function(t){try{var e=JSON.stringify(t);localStorage.setItem(ge,e)}catch(n){console.log("Error saving state",n)}};void 0!==typeof window&&(window.resetLocalStorage=function(){return ke({})});var Ee=n(24),Oe=n.n(Ee),Ce="production";var Se=function(t,e){return n=function(t){var e=t.resources||{};return Object.assign({},e.default,e[Ce])}(t)[e]||"",function(t){return n&&n.replace("{{filename}}",t)};var n},we={getCachedResources:function(t,e){return Qt(t,e,function(){var n={},r=Object.keys(t.clips);return Promise.all(Ae(t,e,r).map(function(t,e){return t.then(function(t){return n[r[e]]=t,t})})),n})},loadResources:Ae,getResourceUrls:xe};function xe(t,e){var n=Object.keys(t.clips),r=Se(t,e);return n.reduce(function(t,e){return t[e]=r(e),t},{})}var Ie=function(t){return t},je={audio:function(t){var e=Oe()();return t.arrayBuffer().then(function(t){return e.decodeAudioData(t)})}};function Ae(t,e,n){n=n||Object.keys(t.clips);var r=Se(t,e),a=je[e]||Ie;return n.map(function(t){return Zt(r(t),a)})}var Me=Oe()(),ze=1;function Te(t,e,n){return t+function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ze;if(!e)return 0;var a=n/(60*r),o=t-e;return 0===o?0:(1-o*a%1)/a}(t,e,n)}var Re=function(){function t(e,n){Object(jt.a)(this,t),this.bpm=e.audio.bpm||120,this.playing=0,this.startedAt=null,this.audioset=e,this.buffers={},this.sources={},this.events=n,this.output=function(t){var e=Me.createGain();return e.gain.value=t,e.connect(Me.destination),e}(.2)}return Object(At.a)(t,[{key:"play",value:function(t,e){e=e||Te(Me.currentTime,this.startedAt,this.bpm);var n=this.buffers[t];n||console.warn("No buffer",t),this.stopTrack(t,e);var r=this.sources[t]=Me.createBufferSource();r.buffer=n,r.loop=!0,r.connect(this.output),r.start(e),this.started(t,e)}},{key:"stop",value:function(t,e){var n=this.sources[t];n&&(e=e||Me.currentTime,n.stop(e),this.sources[t]=null,this.stopped(t,e))}},{key:"stopTrack",value:function(t,e){var n=this,r=this.audioset.clips[t];this.audioset.tracks.find(function(t){return t.id===r.trackId}).clipIds.forEach(function(t){return n.stop(t,e)})}},{key:"stopAll",value:function(){var t=this,e=Me.currentTime;Object.keys(this.sources).forEach(function(n){return t.stop(n,e)})}},{key:"started",value:function(t,e){0===this.playing&&(this.startedAt=e,this.events.audioStarted(e)),this.playing++;var n=this.audioset.clips[t].trackId;this.events.audioClipStarted(t,n,Me.currentTime)}},{key:"stopped",value:function(t,e){var n=this.audioset.clips[t].trackId;this.events.audioClipStopeed(t,n,Me.currentTime),this.playing--,0===this.playing&&(this.startedAt=null,this.events.audioStopped(!1,e))}}]),t}();var Pe=function(t){return{audioStarted:function(e){return t(function(t){return{type:g,time:t}}(e))},audioStopped:function(e){return t(function(t){return{type:k,time:t}}(!1))},audioClipStarted:function(e,n,r){return t(function(t,e,n){return{type:y,clipId:t,trackId:e,status:{isPlaying:!0,time:n}}}(e,n,r))},audioClipStopeed:function(e,n,r){return t(function(t,e,n){return{type:b,clipId:t,trackId:e,status:{isPlaying:!1,time:n}}}(e,n,r))}}},Ve=function(){function t(e){Object(jt.a)(this,t),this.events=Pe(e),this.currentSampler=null,this.samplers={}}return Object(At.a)(t,[{key:"restoreState",value:function(t){var e=t.audioset;e&&(!function(t,e){if(e){var n=function(t,e){var n=e.id;return t.samplers[n]?t.samplers[n]:(t.samplers[n]=new Re(e,t.events),t.samplers[n])}(t,e);n.buffers=we.getCachedResources(e,"audio"),t.currentSampler=n}else t.currentSampler=null}(this,e),this.currentSampler.stopAll())}},{key:"playSample",value:function(t){if(!this.currentSampler)return console.warn("NO sampler!");this.currentSampler.play(t)}},{key:"stopSample",value:function(t,e){if(!this.currentSampler)return console.warn("NO sampler!");this.currentSampler.stop(t)}},{key:"stopAll",value:function(){this.currentSampler&&this.currentSampler.stopAll()}}]),t}();var _e=null;var Le="/app/audiosets",He=function(t){return t.json()};var Ne=n(20);var De=function(t,e){return t.send(JSON.stringify(e))};var Ue=n(43),Ge=n(7),Be=n(42),Fe=n(41),Je=8,qe=2;function We(t){return t/450}function Ke(t){return t/50}function Xe(t){return t/Je}function Ye(t){var e=We(t),n=Ke(t);return Xe(t)+e+2*n}function Qe(t,e){return e*Xe(t)+qe}var Ze={sixteenNinths:16/9,sixteenTenths:1.6};var $e=36,tn=Ge.g().range([0,360]).domain([0,$e]);function en(t,e,n,r,a){var o=a.duration,i=a.trackVolume,s=a.trackColor,c=t.append("g").attr("class","circleGroup").attr("transform","translate(".concat(n,", ").concat(r,")")),l=c.append("g").attr("class","circle"),u=Ge.a(),d=function(t,e,n){return Ge.f(t).map(function(r,a){return{startAngle:nn(tn(r)),endAngle:nn(tn(a===t-1?r+1:r+2)),innerRadius:0,outerRadius:e/30*n*2}})}($e,e,i);l.selectAll(".outerArcs").data(d).enter().append("path").attr("class","outerArcs").attr("d",u).style("fill",s).style("opacity",function(t,e){return.3/$e*e});var p=function(t,e,n){return Ge.f(t).map(function(r,a){return{startAngle:nn(tn(r)),endAngle:nn(tn(a===t-1?r+1:r+2)),innerRadius:0,outerRadius:e/30*n}})}($e,e,i);l.selectAll(".innerArcs").data(p).enter().append("path").attr("class","innerArcs").attr("d",u).style("fill",s).style("opacity",function(t,e){return 1/$e*e}),l.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",-(e/30*i+e/350)).style("stroke",s).style("stroke-width",1.5);var f=Ge.j(function(t){var e=t/1e3%o,n=Ge.g().range([1,0]).domain([0,o]);l.style("transform","rotate(".concat(-n(e),"turn)")),Ge.h(".circle").empty()&&f.stop()});return c}function nn(t){return t*(Math.PI/180)}var rn=n(40);function an(t,e){var n=t.clips[e];if(n){var r=function(t,e){return Qt(t,"coverUrls",function(){return xe(t,"covers")})[e]}(t,n.name),a=t.meta.bpm||120;return{lnglat:n.lnglat,year:n.year,country:n.country,title:n.title,artist:n.artist,album:n.album,trackNumber:n.trackNum,loopend:1,trackVolume:n.audio.trackVolume||.7,duration:60*n.audio.beats/a,imageUrl:r,trackColor:n.display.color}}}var on={geoMapUrl:"https://unpkg.com/world-atlas@1.1.4/world/110m.json",imprint:!1,focus:{lambda:-10,verticalShift:15,scaleFactor:1}},sn=function(t,e){var n=e[t];n&&(n.remove(),e[t]=null)},cn=function(){function t(e,n){Object(jt.a)(this,t),this.config=Object.assign({},on,e.visuals),this.set=e,this.display=n,this.circles={},this.albums={},this.refLines={},this.infos={},this.fixedAspectRatio=Ze.sixteenTenths,this.render=this.render.bind(this)}return Object(At.a)(t,[{key:"setGeodata",value:function(t){this.geodata=t,this.countries=Be.a(t,t.objects.countries).features,this.render()}},{key:"show",value:function(t){var e=an(this.set,t);if(e){var n=this.display.dimensions,r=n.width,a=n.height,o=this.projection(e.lnglat),i=Object(Ue.a)(o,2),s=i[0],c=i[1],l=en(this.circlesContainer,r,s,c,e);this.circles[t]=l;var u=function(t,e,n){var r=n.trackNumber,a=n.imageUrl,o=n.year,i=n.country,s=n.trackColor,c=t.append("g"),l=Xe(e),u=e/300,d=We(e),p=Qe(e,r),f=Ke(e);return c.append("svg:image").attr("width",l).attr("height",l).attr("x",r*l).attr("y",0).style("stroke","white").attr("xlink:href",a),c.append("rect").attr("width",l).attr("height",f).attr("x",r*l).attr("y",l+d).style("fill",s),function(t,e){for(var n=document.getElementById(e).getBBox().width,r=t.text();n>l-2*u&&r.length>0;)r=r.slice(0,-1),t.text(r+"..."),n=document.getElementById(e).getBBox().width}(c.append("text").attr("id","countryText"+r).attr("x",r*l+u).attr("y",l+d+f/2).attr("dy","0.35em").style("font-size","1.1vw").text(i),"countryText"+r),c.append("circle").attr("cx",p).attr("cy",l+d+2*f).attr("r",qe).style("fill",s),c.append("text").attr("x",r*l+u).attr("y",l+d+1.5*f).attr("dy","0.35em").style("font-size","1.1vw").style("fill",s).text(o),c}(this.albumsContainer,r,e);this.albums[t]=u;var d=function(t,e,n,r,a,o){var i=Qe(e,a),s=n,c=r,l=Math.sqrt(Math.pow(s-i,2)+Math.pow(c-0,2)),u=l/10,d=Math.acos((c-0)/l),p=[{x:i,y:0},{x:i+(s-i)/2+u*Math.cos(Math.PI-d),y:0+(c-0)/2+u*Math.sin(Math.PI-d)},{x:s,y:c}],f=Ge.e().x(function(t){return t.x}).y(function(t){return t.y}).curve(Ge.b);return t.append("path").datum(p).attr("d",f).style("stroke",o).style("stroke-dasharray","2, 3").style("fill","none").style("stroke-width",2)}(this.refLinesContainer,r,s,c,e.trackNumber,e.trackColor);this.refLines[t]=d,function(t,e,n,r,a,o){var i=Math.floor(e/30*o),s=Ge.f(i,150),c=t.append("circle").attr("cx",n).attr("cy",r).attr("r",0).style("fill","none").style("stroke",a);s.forEach(function(t,e){var n=2-2*t/150;c.transition().duration(20).delay(20*e).attr("r",t).style("stroke-width",n).on("end",function(e,n,r){149===t&&r[n].remove()})})}(this.wavesContainer,r,s,c,e.trackColor,e.trackVolume);var p,f=function(t,e,n,r){var a=r.title,o=r.artist,i=r.album,s=r.trackColor;t.select("#lastSampleInfoGroup").remove();var c=t.append("g").attr("id","lastSampleInfoGroup"),l=e/20,u=e/190,d=l/3,p=e-l,f=n-Ye(e)-l,h="-0.35em";return c.append("rect").attr("width",l).attr("height",l).attr("x",p).attr("y",f).style("fill",s),c.append("text").attr("x",p+u).attr("y",f+1*d).attr("dy",h).attr("font-size","1.1vw").text("title"),c.append("text").attr("x",p-u).attr("y",f+1*d).attr("dy",h).attr("font-size","1.1vw").style("text-anchor","end").style("fill","#e6e6e6").text(a),c.append("text").attr("x",p+u).attr("y",f+2*d).attr("dy",h).attr("font-size","1.1vw").text("artist"),c.append("text").attr("x",p-u).attr("y",f+2*d).attr("dy",h).attr("font-size","1.1vw").style("text-anchor","end").style("fill","#e6e6e6").text(o),c.append("text").attr("x",p+u).attr("y",f+3*d).attr("dy",h).attr("font-size","1.1vw").text("album"),c.append("text").attr("x",p-u).attr("y",f+3*d).attr("dy",h).attr("font-size","1.1vw").style("text-anchor","end").style("fill","#e6e6e6").text(i),c}(this.lastSampleInfoContainer,r,a,e);this.infos[t]=f,this.config.imprint&&(p=e.lnglat,e.trackColor,Ge.i(".countries").each(function(t){if(Ge.c(t,p)){var e=Ge.h("#country".concat(t.id)).style("fill");Ge.h("#country".concat(t.id)).style("fill",rn(e).brighten(.2))}}))}}},{key:"hide",value:function(t){sn(t,this.circles),sn(t,this.albums),sn(t,this.refLines),sn(t,this.infos)}},{key:"render",value:function(){this.display.clear();var t=this.display.dimensions,e=t.width,n=t.height,r=t.scale*this.config.focus.scaleFactor,a=this.config.focus.lambda,o=this.config.focus.verticalShift,i=Ye(e),s=this.display.svg;if(this.mapContainer=s.append("g").attr("transform","translate(0, ".concat(i,")")).append("g").attr("id","map"),this.albumsContainer=s.append("g").attr("id","albums"),this.refLinesContainer=s.append("g").attr("id","refLines").attr("transform","translate(0, ".concat(i,")")),this.circlesContainer=s.append("g").attr("transform","translate(0, ".concat(i,")")).append("g").attr("id","circles"),this.wavesContainer=s.append("g").attr("id","waves").attr("transform","translate(0, ".concat(i,")")),this.lastSampleInfoContainer=s.append("g").attr("id","lastSampleInfo").attr("transform","translate(0, ".concat(i,")")),this.geodata){this.projection=function(t,e,n,r,a){return Fe.a().scale(n).translate([t/2,e/2+e/r]).rotate([a,0,0])}(e,n-i,r,o,a);var c=Ge.d().projection(this.projection);this.mapContainer.selectAll(".countries").data(this.countries).enter().append("path").attr("id",function(t){return"country".concat(t.id)}).attr("class","countries").attr("d",c).style("stroke","#2c2c2c").style("stroke-width",.5).style("fill",function(t){return"010"===t.id?"none":"#888888"})}}}]),t}(),ln={sixteenNinths:16/9,sixteenTenths:1.6},un=ln.sixteenTenths,dn=function(){function t(e){Object(jt.a)(this,t),this.el=e,this.clear()}return Object(At.a)(t,[{key:"setVisible",value:function(t){this.el.style.display=t?"block":"none"}},{key:"clear",value:function(){var t=Object(Ge.h)(this.el);return t.selectAll("*").remove(),this.dimensions=function(t){var e=t.offsetWidth,n=t.offsetHeight,r=e/n,a=r<un?e:n*un,o=r<un?e/un:n,i=un===ln.sixteenTenths?a/5.9:a/6.5;return{width:a,height:o,scale:i}}(this.el),this.svg=t.append("svg").attr("width",this.dimensions.width).attr("height",this.dimensions.height),this.svg}}]),t}();var pn,fn={init:function(t){t||(t=function(){var t=document.createElement("div");return t.setAttribute("class","visuals"),document.body.appendChild(t),t}());var e,n=new dn(t);return n.setVisible(!1),{setAudioset:function(t){e=t?function(t,e){we.loadResources(t,"covers");var n=new cn(t,e);return n.render(),fetch(t.visuals.geoMapUrl).then(function(t){return t.json()}).then(function(t){return n.setGeodata(t)}),n}(t,n):function(t,e){return e.setVisible(!1),e.clear(),null}(0,n)},startClip:function(t){e.show(t)},stopClip:function(t){e.hide(t)},setVisible:function(t){n.setVisible(t),t&&e&&e.render()}}}};var hn=function(t){return"desktop"===t.display.type};var mn=[function(t){var e,n=!1;return function(t,r){switch(n&&function(t,e,n){var r=!e.clientId,a=e.type.startsWith(c),o=t.readyState===WebSocket.OPEN;r&&a&&o&&De(t,{action:"broadcastAction",payload:e})}(e,t),t.type){case G:e=function(t){var e=t.dispatch,n=t.getState,r=new WebSocket("ws://localhost:8080");return r.onopen=function(){var t=n().sync.user;De(r,{action:"login",payload:t&&t.id})},r.onmessage=function(t){var a=JSON.parse(t.data);switch(console.log("RECEIVED",a),a.event){case"@sync/loggedIn":return e(nt(a.payload));case"@sync/roomList":return e(at(a.payload));case"@sync/requestJoin":De(r,{action:"acceptJoin",payload:a.payload.id});var o=d(n().playback);return void De(r,{action:"broadcastAction",payload:o});case"@sync/joined":return e(rt(a.payload));case"@sync/action":return e(Object.assign(a.payload,{clientId:a.from}));default:return}},r}(r);break;case Z:e.send(JSON.stringify({action:"createRoom"}));break;case et:e.send(JSON.stringify({action:"requestJoin",payload:t.room.id}));break;case $:n=!0}}},function(t,e){var n=e.getState,r=e.dispatch,a=n(),o=!a.session.isControl;switch(t.type){case G:_e=new Ve(r,o),o&&_e.restoreState(a.playback);break;case q:_e.setEnabled(o);break;case u:o&&_e.restoreState(t.playback);break;case f:return o&&_e.playSample(t.clipId);case m:return o&&_e.stopSample(t.clipId);case E:return o&&_e.stopAll()}},function(t,e){var n=e.getState;switch(t.type){case G:pn=fn.init();break;case ht:pn.setVisible(hn(n()));break;case u:pn.setAudioset(t.playback.audioset),pn.setVisible(hn(n()));break;case y:pn.startClip(t.clipId);break;case b:pn.stopClip(t.clipId)}},function(t,e){var n=e.dispatch;switch(t.type){case G:(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le;return Zt("".concat(t,"/audioset.index.json"),He)})().then(function(t){return n(W(t))});break;case J:(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Le;return Zt("".concat(e,"/").concat(t,".audioset.json"),He)})(t.id).then(function(t){return n(p(t))})}},function(t,e){var n=e.dispatch;switch(t.type){case pt:Ne.enabled&&Ne.request();break;case G:!function(t){Ne.enabled&&Ne.on("change",function(){return t(bt(Ne.isFullscreen))});var e=Object(be.throttle)(function(){return t(mt(window.innerWidth,window.innerHeight))},1e3);window.addEventListener("resize",e),e()}(n)}},function(t,e){var n=e.dispatch,r=e.getState;switch(t.type){case"INIT_SIDE_EFFECTS":!function(t,e){var n={};window.onkeydown=function(r){var a=r.key;if(!n[a]){n[a]=!0;var o=e().playback.audioset;if(o){var i=$t(o)[a];i&&t(h(i.clipId))}}},window.onkeyup=function(r){var a=r.key;n[a]=!1;var o=e().playback.audioset;if(o){var i=$t(o)[a];i&&t(v(i.clipId))}}}(n,r);break;default:return}}];var vn=function(){var t=function(){try{var t=localStorage.getItem(ge);if(null===t)return;return JSON.parse(t)}catch(e){return}}(),e=mn.length,n=window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(t){return t},r=Object(C.d)(Object(C.a)(function(t){return function(n){return function(r){n(r);for(var a=0;a<e;a++)mn[a](r,t)}}}),n),a=Object(C.e)(gt,t,r);return a.dispatch({type:G}),a.subscribe(Object(be.throttle)(function(){return ke(function(t){var e=t.playback,n=t.sync;return{playback:e,sync:n}}(a.getState()))},1e3)),a}(),yn=vn.getState(),bn=yn.playback.audioset;yn.playback.audioset&&vn.dispatch(p(bn));var gn=document.getElementById("app");ae.a.setAppElement(gn),i.a.render(a.a.createElement(s.a,{store:vn},a.a.createElement(ye,null)),gn)}},[[47,2,1]]]);
//# sourceMappingURL=main.3706f805.chunk.js.map