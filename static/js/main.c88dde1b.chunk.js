(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(t,e){},115:function(t,e,n){},126:function(t,e,n){"use strict";n.r(e);var r=n(2),a=n.n(r),o=n(9),i=n.n(o),s=n(10),c="[session] SET_AUDIOSET",u=function(t){return{type:c,audioset:t}},l="[session] PRESS_PAD",d=function(t){return{type:l,clipId:t}},h="[session] RELEASE_PAD",f=function(t){return{type:h,clipId:t}},p="[session] SET_AUDIO_CLIP_STATUS",v="[session] SET_AUDIO_STATUS",m=function(t,e){return{type:v,status:{isPlaying:t,time:e}}},y="[session] AUDIO_STOP_ALL",g=function(){return{type:y}},b="[session] CHANGE_TRACK_VOLUME",k=function(t,e){return{type:"ATTACH_VISUALS",audioset:t,el:e}},x=function(){return{type:"DETACH_VISUALS"}},w=[],C=function(t){t&&w.push(t)},E=function(t){var e=t.dispatch,n=t.getState;return function(t){return function(r){t(r);for(var a=0;a<w.length;a++)w[a](r,e,n)}}},O=n(12),V=n(13),j=n(61),z=n.n(j),M=n(62),A=n.n(M),S={on:function(t){console.warn("Add listener to no socket",t)},emit:function(t,e){console.warn("Emit event to no socket",t,e)}},I=function(){function t(e){Object(O.a)(this,t),this.handleAction=function(t){return console.log("unhandled action",t)},this.socket=S,this.connected=!1,this.status={audiosets:[],rooms:[]},this.events=A()(),e&&this.connect(e)}return Object(V.a)(t,[{key:"connect",value:function(t){var e=this;this.socket=z.a.connect(t),this.socket.on("connect",function(){e.connected=!0}),this.socket.on("@rooms/room",function(t){e.events.emit("room",t)}),this.socket.on("@rooms/status",function(t){e.events.emit("status",t)}),this.socket.on("@rooms/action",function(t){e.handleAction(t)})}},{key:"dispatch",value:function(t){this.handleAction(t),this.socket.emit("@rooms/action",t)}},{key:"onAction",value:function(t){this.handleAction=t}},{key:"createRoom",value:function(t){this.socket.emit("@rooms/create",t)}},{key:"joinRoom",value:function(t){this.socket.emit("@rooms/join",t)}},{key:"on",value:function(t,e){this.events.on(t,e)}}]),t}(),P=[];function T(t,e){return t.startsWith("audioset://")&&console.log("save",t,e),P[t]=e,e}function H(t){return P[t]}function R(t){return void 0!==P[t]}function L(t,e,n){var r="audioset://".concat(t.id,"/").concat(e);return R(r)?H(r):T(r,n())}function N(t,e){return R(t)?Promise.resolve(H(t)):(console.log("Fetch",t),fetch(t).then(e).then(function(e){return T(t,e)}))}var _=n(30),U=n.n(_),D="production";var F=function(t,e){return n=function(t){var e=t.resources||{};return Object.assign({},e.default,e[D])}(t)[e]||"",function(t){return n&&n.replace("{{filename}}",t)};var n},B={getCachedResources:function(t,e){return L(t,e,function(){var n={},r=Object.keys(t.clips);return Promise.all(X(t,e,r).map(function(t,e){return t.then(function(t){return n[r[e]]=t,t})})),n})},loadResources:X,getResourceUrls:G};function G(t,e){var n=Object.keys(t.clips),r=F(t,e);return n.reduce(function(t,e){return t[e]=r(e),t},{})}var q=function(t){return t},J={audio:function(t){var e=U()();return t.arrayBuffer().then(function(t){return e.decodeAudioData(t)})}};function X(t,e,n){n=n||Object.keys(t.clips);var r=F(t,e),a=J[e]||q;return n.map(function(t){return N(r(t),a)})}var K="/app/audiosets",W=function(t){return t.json()};function Q(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K;return N("".concat(e,"/").concat(t,".audioset.json"),W)}var Y=U()(),Z=1;function $(t,e,n){return t+function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Z;if(!e)return 0;var a=n/(60*r),o=t-e;return 0===o?0:(1-o*a%1)/a}(t,e,n)}var tt=function(){function t(e,n){Object(O.a)(this,t),this.bpm=e.audio.bpm||120,this.playing=0,this.startedAt=null,this.audioset=e,this.buffers={},this.sources={},this.dispatch=n,this.output=function(t){var e=Y.createGain();return e.gain.value=t,e.connect(Y.destination),e}(.2)}return Object(V.a)(t,[{key:"play",value:function(t,e){e=e||$(Y.currentTime,this.startedAt,this.bpm);var n=this.buffers[t];n||console.warn("No buffer",t),this.stopTrack(t,e);var r=this.sources[t]=Y.createBufferSource();r.buffer=n,r.loop=!0,r.connect(this.output),r.start(e),this.started(t,e)}},{key:"stop",value:function(t,e){var n=this.sources[t];n&&(e=e||Y.currentTime,n.stop(e),this.sources[t]=null,this.stopped(t,e))}},{key:"stopTrack",value:function(t,e){var n=this,r=this.audioset.clips[t];this.audioset.tracks.find(function(t){return t.id===r.trackId}).clipIds.forEach(function(t){return n.stop(t,e)})}},{key:"stopAll",value:function(){var t=this,e=Y.currentTime;Object.keys(this.sources).forEach(function(n){return t.stop(n,e)})}},{key:"started",value:function(t,e){0===this.playing&&(this.startedAt=e,this.dispatch(m(!0,e))),this.playing++;var n=this.audioset.clips[t].trackId;this.dispatch(function(t,e,n){return{type:p,clipId:t,trackId:e,status:{isPlaying:!0,time:n}}}(t,n,Y.currentTime))}},{key:"stopped",value:function(t,e){var n=this.audioset.clips[t].trackId;this.dispatch(function(t,e,n){return{type:p,clipId:t,trackId:e,status:{isPlaying:!1,time:n}}}(t,n,Y.currentTime)),this.playing--,0===this.playing&&(this.startedAt=null,this.dispatch(m(!1,e)))}}]),t}();var et={effects:function(t){var e=t.getSession,n=t.dispatch;t.addEffect;return function(t,e){t.audioset&&ot(t.audioset,e);e(g())}(e(),n),function(t){switch(t.type){case c:return ot(t.audioset,n);case l:return function(t,e){if(!at)return console.warn("NO sampler!");at.play(t)}(t.clipId);case h:return function(t,e){if(!at)return console.warn("NO sampler!");at.stop(t)}(t.clipId);case y:return at.stopAll()}}}},nt={},rt=function(t,e){var n=t.id;return nt[n]?nt[n]:(nt[n]=new tt(t,e),nt[n])},at=null;function ot(t,e){t?(at=rt(t,e)).buffers=B.getCachedResources(t,"audio"):at=null}var it=n(31),st=n(18),ct=n(5),ut=n(69),lt=n(68),dt=8,ht=2;function ft(t){return t/450}function pt(t){return t/50}function vt(t){return t/dt}function mt(t){var e=ft(t),n=pt(t);return vt(t)+e+2*n}function yt(t,e){return e*vt(t)+ht}var gt={sixteenNinths:16/9,sixteenTenths:1.6};var bt=36,kt=ct.g().range([0,360]).domain([0,bt]);function xt(t,e,n,r,a){var o=a.duration,i=a.trackVolume,s=a.trackColor,c=t.append("g").attr("class","circleGroup").attr("transform","translate(".concat(n,", ").concat(r,")")),u=c.append("g").attr("class","circle"),l=ct.a(),d=function(t,e,n){return ct.f(t).map(function(r,a){return{startAngle:wt(kt(r)),endAngle:wt(kt(a===t-1?r+1:r+2)),innerRadius:0,outerRadius:e/30*n*2}})}(bt,e,i);u.selectAll(".outerArcs").data(d).enter().append("path").attr("class","outerArcs").attr("d",l).style("fill",s).style("opacity",function(t,e){return.3/bt*e});var h=function(t,e,n){return ct.f(t).map(function(r,a){return{startAngle:wt(kt(r)),endAngle:wt(kt(a===t-1?r+1:r+2)),innerRadius:0,outerRadius:e/30*n}})}(bt,e,i);u.selectAll(".innerArcs").data(h).enter().append("path").attr("class","innerArcs").attr("d",l).style("fill",s).style("opacity",function(t,e){return 1/bt*e}),u.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",-(e/30*i+e/350)).style("stroke",s).style("stroke-width",1.5);var f=ct.j(function(t){var e=t/1e3%o,n=ct.g().range([1,0]).domain([0,o]);u.style("transform","rotate(".concat(-n(e),"turn)")),ct.h(".circle").empty()&&f.stop()});return c}function wt(t){return t*(Math.PI/180)}var Ct=n(63);function Et(t,e){var n=t.clips[e];if(n){var r=function(t,e){return L(t,"coverUrls",function(){return G(t,"covers")})[e]}(t,n.name),a=t.meta.bpm||120;return{lnglat:n.lnglat,year:n.year,country:n.country,title:n.title,artist:n.artist,album:n.album,trackNumber:n.trackNum,loopend:1,trackVolume:n.audio.trackVolume||.7,duration:60*n.audio.beats/a,imageUrl:r,trackColor:n.display.color}}}var Ot={geoMapUrl:"https://unpkg.com/world-atlas@1.1.4/world/110m.json",imprint:!1,focus:{lambda:-10,verticalShift:15,scaleFactor:1}},Vt=function(t,e){var n=e[t];n&&(n.remove(),e[t]=null)},jt=function(){function t(e,n){Object(O.a)(this,t),this.config=Object.assign({},Ot,e.visuals),this.set=e,this.display=n,this.circles={},this.albums={},this.refLines={},this.infos={},this.fixedAspectRatio=gt.sixteenTenths,this.render=this.render.bind(this)}return Object(V.a)(t,[{key:"setGeodata",value:function(t){this.geodata=t,this.countries=ut.a(t,t.objects.countries).features,this.render()}},{key:"show",value:function(t){var e=Et(this.set,t);if(e){var n=this.display.dimensions,r=n.width,a=n.height,o=this.projection(e.lnglat),i=Object(st.a)(o,2),s=i[0],c=i[1],u=xt(this.circlesContainer,r,s,c,e);this.circles[t]=u;var l=function(t,e,n){var r=n.trackNumber,a=n.imageUrl,o=n.year,i=n.country,s=n.trackColor,c=t.append("g"),u=vt(e),l=e/300,d=ft(e),h=yt(e,r),f=pt(e);return c.append("svg:image").attr("width",u).attr("height",u).attr("x",r*u).attr("y",0).style("stroke","white").attr("xlink:href",a),c.append("rect").attr("width",u).attr("height",f).attr("x",r*u).attr("y",u+d).style("fill",s),function(t,e){for(var n=document.getElementById(e).getBBox().width,r=t.text();n>u-2*l&&r.length>0;)r=r.slice(0,-1),t.text(r+"..."),n=document.getElementById(e).getBBox().width}(c.append("text").attr("id","countryText"+r).attr("x",r*u+l).attr("y",u+d+f/2).attr("dy","0.35em").style("font-size","1.1vw").text(i),"countryText"+r),c.append("circle").attr("cx",h).attr("cy",u+d+2*f).attr("r",ht).style("fill",s),c.append("text").attr("x",r*u+l).attr("y",u+d+1.5*f).attr("dy","0.35em").style("font-size","1.1vw").style("fill",s).text(o),c}(this.albumsContainer,r,e);this.albums[t]=l;var d=function(t,e,n,r,a,o){var i=yt(e,a),s=n,c=r,u=Math.sqrt(Math.pow(s-i,2)+Math.pow(c-0,2)),l=u/10,d=Math.acos((c-0)/u),h=[{x:i,y:0},{x:i+(s-i)/2+l*Math.cos(Math.PI-d),y:0+(c-0)/2+l*Math.sin(Math.PI-d)},{x:s,y:c}],f=ct.e().x(function(t){return t.x}).y(function(t){return t.y}).curve(ct.b);return t.append("path").datum(h).attr("d",f).style("stroke",o).style("stroke-dasharray","2, 3").style("fill","none").style("stroke-width",2)}(this.refLinesContainer,r,s,c,e.trackNumber,e.trackColor);this.refLines[t]=d,function(t,e,n,r,a,o){var i=Math.floor(e/30*o),s=ct.f(i,150),c=t.append("circle").attr("cx",n).attr("cy",r).attr("r",0).style("fill","none").style("stroke",a);s.forEach(function(t,e){var n=2-2*t/150;c.transition().duration(20).delay(20*e).attr("r",t).style("stroke-width",n).on("end",function(e,n,r){149===t&&r[n].remove()})})}(this.wavesContainer,r,s,c,e.trackColor,e.trackVolume);var h,f=function(t,e,n,r){var a=r.title,o=r.artist,i=r.album,s=r.trackColor;t.select("#lastSampleInfoGroup").remove();var c=t.append("g").attr("id","lastSampleInfoGroup"),u=e/20,l=e/190,d=u/3,h=e-u,f=n-mt(e)-u,p="-0.35em";return c.append("rect").attr("width",u).attr("height",u).attr("x",h).attr("y",f).style("fill",s),c.append("text").attr("x",h+l).attr("y",f+1*d).attr("dy",p).attr("font-size","1.1vw").text("title"),c.append("text").attr("x",h-l).attr("y",f+1*d).attr("dy",p).attr("font-size","1.1vw").style("text-anchor","end").style("fill","#e6e6e6").text(a),c.append("text").attr("x",h+l).attr("y",f+2*d).attr("dy",p).attr("font-size","1.1vw").text("artist"),c.append("text").attr("x",h-l).attr("y",f+2*d).attr("dy",p).attr("font-size","1.1vw").style("text-anchor","end").style("fill","#e6e6e6").text(o),c.append("text").attr("x",h+l).attr("y",f+3*d).attr("dy",p).attr("font-size","1.1vw").text("album"),c.append("text").attr("x",h-l).attr("y",f+3*d).attr("dy",p).attr("font-size","1.1vw").style("text-anchor","end").style("fill","#e6e6e6").text(i),c}(this.lastSampleInfoContainer,r,a,e);this.infos[t]=f,this.config.imprint&&(h=e.lnglat,e.trackColor,ct.i(".countries").each(function(t){if(ct.c(t,h)){var e=ct.h("#country".concat(t.id)).style("fill");ct.h("#country".concat(t.id)).style("fill",Ct(e).brighten(.2))}}))}}},{key:"hide",value:function(t){Vt(t,this.circles),Vt(t,this.albums),Vt(t,this.refLines),Vt(t,this.infos)}},{key:"render",value:function(){this.display.clear();var t=this.display.dimensions,e=t.width,n=t.height,r=t.scale*this.config.focus.scaleFactor,a=this.config.focus.lambda,o=this.config.focus.verticalShift,i=mt(e),s=this.display.svg;if(this.mapContainer=s.append("g").attr("transform","translate(0, ".concat(i,")")).append("g").attr("id","map"),this.albumsContainer=s.append("g").attr("id","albums"),this.refLinesContainer=s.append("g").attr("id","refLines").attr("transform","translate(0, ".concat(i,")")),this.circlesContainer=s.append("g").attr("transform","translate(0, ".concat(i,")")).append("g").attr("id","circles"),this.wavesContainer=s.append("g").attr("id","waves").attr("transform","translate(0, ".concat(i,")")),this.lastSampleInfoContainer=s.append("g").attr("id","lastSampleInfo").attr("transform","translate(0, ".concat(i,")")),this.geodata){this.projection=function(t,e,n,r,a){return lt.a().scale(n).translate([t/2,e/2+e/r]).rotate([a,0,0])}(e,n-i,r,o,a);var c=ct.d().projection(this.projection);this.mapContainer.selectAll(".countries").data(this.countries).enter().append("path").attr("id",function(t){return"country".concat(t.id)}).attr("class","countries").attr("d",c).style("stroke","#2c2c2c").style("stroke-width",.5).style("fill",function(t){return"010"===t.id?"none":"#888888"})}}}]),t}(),zt={sixteenNinths:16/9,sixteenTenths:1.6},Mt=zt.sixteenTenths,At=function(){function t(e){Object(O.a)(this,t),this.el=e,this.clear()}return Object(V.a)(t,[{key:"setVisible",value:function(t){this.el.style.display=t?"block":"none"}},{key:"clear",value:function(){var t=Object(ct.h)(this.el);return t.selectAll("*").remove(),this.dimensions=function(t){var e=t.offsetWidth,n=t.offsetHeight,r=e/n,a=r<Mt?e:n*Mt,o=r<Mt?e/Mt:n,i=Mt===zt.sixteenTenths?a/5.9:a/6.5;return{width:a,height:o,scale:i}}(this.el),this.svg=t.append("svg").attr("width",this.dimensions.width).attr("height",this.dimensions.height),this.svg}}]),t}();var St={init:function(t){t||(t=function(){var t=document.createElement("div");return t.setAttribute("class","visuals"),document.body.appendChild(t),t}());var e,n=new At(t);n.setVisible(!1);var r=Object(it.throttle)(function(){e&&e.render()},1e3);return window.addEventListener("resize",r),function(t){switch(t.type){case c:e=t.audioset?function(t,e){e.setVisible(!0);var n=new jt(t,e);return n.render(),fetch(t.visuals.geoMapUrl).then(function(t){return t.json()}).then(function(t){return n.setGeodata(t)}),n}(t.audioset,n):function(t,e){return e.setVisible(!1),null}(0,n);break;case p:var r=t.clipId;t.status.isPlaying?e.show(r):e.hide(r)}}}};var It=n(14),Pt=n(7),Tt=n(6),Ht=n.n(Tt),Rt={stop:"M6 6h12v12H6z",fly:"M17.218,2.268L2.477,8.388C2.13,8.535,2.164,9.05,2.542,9.134L9.33,10.67l1.535,6.787c0.083,0.377,0.602,0.415,0.745,0.065l6.123-14.74C17.866,2.46,17.539,2.134,17.218,2.268 M3.92,8.641l11.772-4.89L9.535,9.909L3.92,8.641z M11.358,16.078l-1.268-5.613l6.157-6.157L11.358,16.078z",mute:"M18.084,11.639c0.168,0.169,0.168,0.442,0,0.611c-0.084,0.084-0.195,0.127-0.306,0.127c-0.111,0-0.221-0.043-0.306-0.127l-1.639-1.639l-1.639,1.639c-0.084,0.084-0.195,0.127-0.306,0.127c-0.111,0-0.222-0.043-0.307-0.127c-0.168-0.169-0.168-0.442,0-0.611L15.223,10l-1.64-1.639c-0.168-0.168-0.168-0.442,0-0.61c0.17-0.169,0.442-0.169,0.612,0l1.639,1.639l1.639-1.639c0.169-0.169,0.442-0.169,0.611,0c0.168,0.168,0.168,0.442,0,0.61L16.445,10L18.084,11.639z M12.161,2.654v14.691c0,0.175-0.105,0.333-0.267,0.4c-0.054,0.021-0.109,0.032-0.166,0.032c-0.111,0-0.223-0.043-0.305-0.127l-3.979-3.979H2.222c-0.237,0-0.432-0.194-0.432-0.432V6.759c0-0.237,0.195-0.432,0.432-0.432h5.222l3.979-3.978c0.123-0.125,0.309-0.163,0.471-0.095C12.056,2.322,12.161,2.479,12.161,2.654 M7.192,7.192H2.654v5.617h4.538V7.192z M11.296,3.698l-3.24,3.241v6.123l3.24,3.24V3.698z",cinema:"M18.175,4.142H1.951C1.703,4.142,1.5,4.344,1.5,4.592v10.816c0,0.247,0.203,0.45,0.451,0.45h16.224c0.247,0,0.45-0.203,0.45-0.45V4.592C18.625,4.344,18.422,4.142,18.175,4.142 M4.655,14.957H2.401v-1.803h2.253V14.957zM4.655,12.254H2.401v-1.803h2.253V12.254z M4.655,9.549H2.401V7.747h2.253V9.549z M4.655,6.846H2.401V5.043h2.253V6.846zM14.569,14.957H5.556V5.043h9.013V14.957z M17.724,14.957h-2.253v-1.803h2.253V14.957z M17.724,12.254h-2.253v-1.803h2.253V12.254zM17.724,9.549h-2.253V7.747h2.253V9.549z M17.724,6.846h-2.253V5.043h2.253V6.846z",controls:"M6.176,7.241V6.78c0-0.221-0.181-0.402-0.402-0.402c-0.221,0-0.403,0.181-0.403,0.402v0.461C4.79,7.416,4.365,7.955,4.365,8.591c0,0.636,0.424,1.175,1.006,1.35v3.278c0,0.222,0.182,0.402,0.403,0.402c0.222,0,0.402-0.181,0.402-0.402V9.941c0.582-0.175,1.006-0.714,1.006-1.35C7.183,7.955,6.758,7.416,6.176,7.241 M5.774,9.195c-0.332,0-0.604-0.272-0.604-0.604c0-0.332,0.272-0.604,0.604-0.604c0.332,0,0.604,0.272,0.604,0.604C6.377,8.923,6.105,9.195,5.774,9.195 M10.402,10.058V6.78c0-0.221-0.181-0.402-0.402-0.402c-0.222,0-0.402,0.181-0.402,0.402v3.278c-0.582,0.175-1.006,0.714-1.006,1.35c0,0.637,0.424,1.175,1.006,1.351v0.461c0,0.222,0.181,0.402,0.402,0.402c0.221,0,0.402-0.181,0.402-0.402v-0.461c0.582-0.176,1.006-0.714,1.006-1.351C11.408,10.772,10.984,10.233,10.402,10.058M10,12.013c-0.333,0-0.604-0.272-0.604-0.604S9.667,10.805,10,10.805c0.332,0,0.604,0.271,0.604,0.604S10.332,12.013,10,12.013M14.629,8.448V6.78c0-0.221-0.182-0.402-0.403-0.402c-0.221,0-0.402,0.181-0.402,0.402v1.668c-0.581,0.175-1.006,0.714-1.006,1.35c0,0.636,0.425,1.176,1.006,1.351v2.07c0,0.222,0.182,0.402,0.402,0.402c0.222,0,0.403-0.181,0.403-0.402v-2.07c0.581-0.175,1.006-0.715,1.006-1.351C15.635,9.163,15.21,8.624,14.629,8.448 M14.226,10.402c-0.331,0-0.604-0.272-0.604-0.604c0-0.332,0.272-0.604,0.604-0.604c0.332,0,0.604,0.272,0.604,0.604C14.83,10.13,14.558,10.402,14.226,10.402 M17.647,3.962H2.353c-0.221,0-0.402,0.181-0.402,0.402v11.27c0,0.222,0.181,0.402,0.402,0.402h15.295c0.222,0,0.402-0.181,0.402-0.402V4.365C18.05,4.144,17.869,3.962,17.647,3.962 M17.245,15.232H2.755V4.768h14.49V15.232z",stop2:"M10 0c-5.523 0-10 4.477-10 10s4.477 10 10 10 10-4.477 10-10-4.477-10-10-10zM10 18.125c-4.487 0-8.125-3.638-8.125-8.125s3.638-8.125 8.125-8.125 8.125 3.638 8.125 8.125-3.638 8.125-8.125 8.125zM6.25 6.25h7.5v7.5h-7.5z",fullscreen:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z",keyboard:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z",volumeUp:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z",volumeDown:"M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z",volumeOff:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"},Lt=function(t){var e=t.icon,n=t.color,r=t.onClick;return a.a.createElement("svg",{fill:n||"#CCC",onClick:r,height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:Rt[e]||e}))},Nt=Ht()("button")({color:"black",display:"block",background:"white",font:"inherit",padding:"0 1em",":hover":{textDecoration:"underline"}}),_t=Ht()("button")({color:"white",display:"block",background:"none",font:"inherit",border:0}),Ut=Ht()("div")({}),Dt=Ht()("div")({marginTop:"3px",flexGrow:1,textAlign:"center"}),Ft=Ht()(function(t){var e=t.className,n=t.audioset,r=t.audio,o=t.onCloseAudioset,i=t.onStopAll,s=t.onHelp,c=t.onToggleTracks,u=t.onTogglePads,l=t.onFullscreen;return a.a.createElement("header",{className:e},a.a.createElement("div",null,a.a.createElement(Lt,{icon:"fly",onClick:s})),a.a.createElement(Dt,{id:"Connection",onClick:o},n.meta.title,": ",n.meta.description),a.a.createElement(Ut,{id:"Transport"},r.isPlaying?a.a.createElement(Lt,{icon:"stop",onClick:i}):"",a.a.createElement(Lt,{icon:"mute"})),a.a.createElement(Lt,{icon:"controls",onClick:u}),a.a.createElement(Lt,{icon:"controls",onClick:c}),a.a.createElement(Lt,{icon:"cinema",onClick:l}))})({display:"flex",flexDirection:"row",backgroundColor:"black",padding:"2px 10px"}),Bt=n(16),Gt=n.n(Bt),qt=Gt()({margin:"0 auto",lineHeight:"2em",fontSize:"14px",backgroundColor:"black","& h1, & h2":{fontWeight:400,margin:"1em 0"}}),Jt=function(t){var e=t.audioset,n=t.audiosetIndex,r=t.onChangeAudioset,o=t.onCloseAudioset;return a.a.createElement("div",{className:qt},n&&!e&&a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Empieza una nueva remezcla"),n.map(function(t){return a.a.createElement(_t,{key:t.id,onClick:function(){return r(t)}},t.meta.title,": ",t.meta.description)})),e&&a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null,e.meta.title),a.a.createElement("p",null,e.meta.description),a.a.createElement(Nt,{onClick:o},"Cerrar audioset")))},Xt=Object(s.b)(function(t){return t},function(t){return{onChangeAudioset:function(e){return t(u(e))}}})(function(t){var e=t.audioset,n=t.onClose,o=t.onChangeAudioset,i=Object(r.useState)(!0),s=Object(st.a)(i,2),c=(s[0],s[1]),u=Object(r.useState)(null),l=Object(st.a)(u,2),d=l[0],h=l[1];Object(r.useEffect)(function(){var t=!0;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K;return N("".concat(t,"/audioset.index.json"),W)}().then(function(e){return t&&h(e)}),function(){return t=!1}},[e]);return a.a.createElement(Jt,{audioset:e,audiosetIndex:d,onChangeAudioset:function(t){c(!0),Q(t.id).then(o).then(n)},onCloseAudioset:function(){return o(null)}})}),Kt=(Gt()({backgroundColor:"gray",height:"100%"}),n(70)),Wt=n(64),Qt=n(72),Yt=(n(115),function(t){function e(t){var n;return Object(O.a)(this,e),(n=Object(Kt.a)(this,Object(Wt.a)(e).call(this,t))).touched=!1,n}return Object(Qt.a)(e,t),Object(V.a)(e,[{key:"handlePress",value:function(t){if(t)this.touched=!0;else if(!0===this.touched)return void(this.touched=!1);var e=!this.props.pressed;this.props[e?"onPress":"onRelease"](this.props.name)}},{key:"render",value:function(){var t=this,e=this.props,n=e.color,r=e.pressed,o=e.touch,i=e.image,s=e.name;return a.a.createElement("button",{className:"Pad ".concat(r?"pressed":""),style:{borderColor:n},onTouchStart:o?function(){return t.handlePress(!0)}:void 0,onMouseDown:function(){return t.handlePress(!1)}},i?a.a.createElement("img",{src:i,alt:s}):"")}}]),e}(a.a.Component)),Zt=function(t){var e=t.track,n=t.status,r=t.onPadPressed,o=t.onPadReleased;return a.a.createElement("div",null,e.clipIds.map(function(t){return a.a.createElement(Yt,{key:t,name:t,pressed:n[t]&&n[t].isPlaying,color:e.color,onPress:r,onRelease:o})}))},$t=Ht()(function(t){var e=t.audioset,n=t.status,r=t.className,o=t.onPadPressed,i=t.onPadReleased;return a.a.createElement("div",{className:r},e.tracks.map(function(t){return a.a.createElement(Zt,{key:t.name,track:t,status:n,onPadPressed:o,onPadReleased:i})}))})({backgroundColor:"black",padding:"0 0.5em 0 1em",minHeight:"100%"}),te=Object(s.b)(function(t){return{audioset:t.audioset,status:t.audio.status}},function(t){return{onPadPressed:function(e){return t(d(e))},onPadReleased:function(e){return t(f(e))}}})($t),ee=n(0),ne=n.n(ee),re=Ht()(function(t){var e=t.onPress,n=t.onRelease,r=t.className,o=t.children;return a.a.createElement("button",{className:r,onMouseDown:e,onMouseUp:n},o)})(function(t){return{border:"2px solid ".concat(t.color),color:t.color,backgroundColor:t.pressed?t.color:"black",marginRight:"0.5em",padding:"1px 3px","&:hover":{backgroundColor:t.color,color:"black"}}});re.propTypes={color:ne.a.string};var ae=re,oe=Ht()("div")(function(t){return{color:t.color,borderTop:"2px solid ".concat(t.active?t.color:"black"),"> h2":{marginTop:"5px"},marginBottom:"1em"}}),ie=Gt()({padding:"1em",backgroundColor:"black"}),se=function(t){var e=t.audioset,n=t.volumes,r=t.playing,o=t.status,i=t.onVolumeChanged,s=t.onPress,c=t.onRelease;return a.a.createElement("div",{className:ie},a.a.createElement("h2",null,"Tracks"),e.tracks.map(function(t){return a.a.createElement(oe,{key:t.id,active:r[t.id],color:t.color},a.a.createElement("h2",null,t.id),a.a.createElement("div",null,t.clipIds.map(function(t){return a.a.createElement(ae,{key:t,pressed:o[t]&&o[t].isPlaying,onPress:function(){return s(t)},onRelease:function(){return c(t)},color:e.clips[t].display.color},t)})),a.a.createElement("input",{type:"range",min:"0",max:"100",value:n[t.id],onChange:function(e){return i(t.id,e.target.value)}}))}))},ce=Object(s.b)(function(t){return{audioset:t.audioset,status:t.audio.status,volumes:t.tracks.volumes,playing:t.tracks.playing}},function(t){return{onVolumeChanged:function(e,n){return t({type:b,trackId:e,volume:n})},onPress:function(e){return t(d(e))},onRelease:function(e){return t(f(e))}}})(se);function ue(t){return L(t,"keyboardMap",function(){return function(t){if(!t)return{};var e=t.defaults,n=t.keyMap;return Object.keys(n).reduce(function(t,r){var a=Object(Pt.a)({},e,n[r]);return a.key=r,t[r]=a,t[r.toUpperCase()]=a,t[a.clipId]=a,t},{})}(t.keyboard)})}var le={effects:function(t){var e=t.getSession,n=t.dispatch,r={};window.onkeydown=function(t){var a=t.key;if(!r[a]){r[a]=!0;var o=e().audioset;if(o){var i=ue(o)[a];i&&n(d(i.clipId))}}},window.onkeyup=function(t){var a=t.key;r[a]=!1;var o=e().audioset;if(o){var i=ue(o)[a];i&&n(f(i.clipId))}}}},de=Ht()(ae)(function(t){return{marginRight:"0.5em",padding:"1px 3px"}}),he=Ht()(function(t){var e=t.audioset,n=t.status,r=t.className,o=t.onPress,i=t.onRelease,s=ue(e);return a.a.createElement("div",{className:r,id:"Keyboard"},e.tracks.map(function(t){return t.clipIds.map(function(e){return a.a.createElement(de,{key:e,pressed:n[e]&&n[e].isPlaying,color:t.color,onPress:function(){return o(e)},onRelease:function(){return i(e)}},s[e]?s[e].key.toUpperCase():"-")})}))})({backgroundColor:"black",textAlign:"center",padding:"2px 10px 4px 10px"}),fe=Object(s.b)(function(t){return{audioset:t.audioset,status:t.audio.status}},function(t){return{onPress:function(e){return t(d(e))},onRelease:function(e){return t(f(e))}}})(he),pe=n(32),ve=n.n(pe),me=n(19),ye={changeFullscreen:function(t){me.enabled&&(t?me.request():me.exit())},onChange:function(t){me.enabled&&me.on("change",function(){return t(me.isFullscreen)})}};var ge=n(71),be=[{target:"#Connection",content:"Has creado una sesi\xf3n. Puedes cambiarla o conectar con otros dispositivos aqu\xed",placement:"bottom",disableBeacon:!0},{target:"#Keyboard",content:"Usa el teclado para lanzar los sonidos. Tambi\xe9n puedes usar MIDI o un MakeyMakey!",placement:"top",disableBeacon:!0},{target:"#Transport",content:"Ponlo en pantalla completa o abre los controles",disableBeacon:!0}],ke={back:"Anterior",close:"Cerrar",last:"Ok, lo he pillado",next:"Siguiente",skip:"Salir"},xe={options:{arrowColor:"#111",backgroundColor:"#111",beaconSize:70,overlayColor:"rgba(255, 255, 255, 0.5)",primaryColor:"#000",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"white",width:void 0,zIndex:100},tooltip:{fontSize:14,fontFamily:"system"},buttonSkip:{fontSize:12}},we=function(t){var e=t.run,n=t.onStop;return a.a.createElement(ge.a,{callback:function(t){return"reset"===t.action&&n()},run:e,locale:ke,styles:xe,showProgress:!1,showSkipButton:!0,continuous:!0,steps:be})},Ce=function(t){return{type:"help",isVisible:t}},Ee=function(t){return{type:"welcome",isVisible:t}};function Oe(t,e){switch(e.type){case"welcome":return Object(Pt.a)({},t,{welcomeVisible:e.isVisible});case"fullscreen":return Object(Pt.a)({},t,{isFullscreen:e.isFullscreen});case"help":return Object(Pt.a)({},t,{help:e.isVisible});case"pads":return Object(Pt.a)({},t,{padsVisible:e.isVisible});case"tracks":return Object(Pt.a)({},t,{tracksVisible:e.isVisible});default:return t}}var Ve={overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:900},content:{position:"fixed",maxHeight:"calc(100% - 100px)",top:"50%",left:"50%",transform:"translate(-50%, -50%)",border:"",background:"black",borderRadius:0,zIndex:1e3}},je=Ht()("div")({display:"flex",flexDirection:"column",minHeight:"100vh"}),ze=Ht()("div")({display:"flex",flexGrow:1,flexDirection:"row",height:"100%",minHeight:"100%",maxHeight:"100%",overflow:"hidden"}),Me=Ht()("div")({flexGrow:1}),Ae=function(t){var e=t.audioset,n=(t.attachVisuals,t.detachVisuals,Object(r.useReducer)(Oe,function(t){return{isFullscreen:!1,welcomeVisible:!t,padsVisible:!1,tracksVisible:!1,help:!1}}(e))),o=Object(st.a)(n,2),i=o[0],s=o[1],c=function(){return s(Ee(!1))};Object(r.useEffect)(function(){return ye.onChange(function(t){return s(function(t){return{type:"fullscreen",isFullscreen:t}}(t))})},[]);var u=!i.isFullscreen;return a.a.createElement(a.a.Fragment,null,e&&a.a.createElement(je,{className:"App"},a.a.createElement(we,{run:i.help,onStop:function(){return s(Ce(!1))}}),u&&a.a.createElement(Ft,{audioset:e,onHelp:function(){return s(Ce(!0))},audio:{},onCloseAudioset:function(){return s(Ee(!0))},onTogglePads:function(){return s({type:"pads",isVisible:!i.padsVisible})},onToggleTracks:function(){return s({type:"tracks",isVisible:!i.tracksVisible})},onFullscreen:function(){return ye.changeFullscreen(!i.isFullscreen)}}),a.a.createElement(ze,null,u&&i.padsVisible&&a.a.createElement(te,null),a.a.createElement(Me,null),u&&i.tracksVisible&&a.a.createElement(ce,null)),u&&a.a.createElement(fe,null)),a.a.createElement(ve.a,{isOpen:!e||i.welcomeVisible,shouldCloseOnOverlayClick:!0,onRequestClose:c,style:Ve},a.a.createElement(Xt,{onClose:c})))},Se=Object(s.b)(function(t){return{audioset:t.audioset}},function(t){return Object(It.b)({attachVisuals:k,detachVisuals:x},t)})(Ae),Ie=function(t){var e=t.events;return a.a.createElement(Se,{events:e})},Pe="atpls/session";var Te=Object(it.throttle)(function(t){try{var e=JSON.stringify(t);localStorage.setItem(Pe,e)}catch(n){console.log("Error saving state",n)}},1e3);void 0!==typeof window&&(window.resetLocalStorage=function(){return Te({})});var He=null;var Re=n(17),Le={isPlaying:!1,status:{}};var Ne={playing:{},volumes:{}},_e=function(t,e){return t?t.tracks.reduce(function(t,n){return t[n.id]=e,t},{}):{}};var Ue=Object(It.c)({audioset:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,e=arguments.length>1?arguments[1]:void 0;return e.type===c?e.audioset:t},audio:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case v:return Object(Pt.a)({},t,{isPlaying:e.status.isPlaying,time:e.status.time});case p:return Object(Pt.a)({},t,{status:Object(Pt.a)({},t.status,Object(Re.a)({},e.clipId,e.status))});case y:return Object(Pt.a)({},t,{status:{}});default:return t}},tracks:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case c:return{playing:_e(e.audioset,0),volumes:_e(e.audioset,75)};case p:var n=e.trackId,r=e.status.isPlaying?1:-1;return Object(Pt.a)({},t,{playing:Object(Pt.a)({},t.playing,Object(Re.a)({},n,t.playing[n]+r))});case b:return Object(Pt.a)({},t,{volumes:Object(Pt.a)({},t.volumes,Object(Re.a)({},e.trackId,e.value))});default:return t}}}),De="production",Fe=function(){var t=function(){try{var t=localStorage.getItem(Pe);if(null===t)return;return JSON.parse(t)}catch(e){return}}(),e=Object(It.d)(Object(It.a)(E),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(t){return t}),n=Object(It.e)(Ue,t,e);return n.subscribe(function(){return Te(n.getState())}),n}(),Be={getSession:Fe.getState,getAudioset:function(){return Fe.getState().audioset},dispatch:Fe.dispatch};!function(t){var e=t.getSession().audioset;e&&("development"===De?Q(e.id).then(function(e){return t.dispatch(u(e))}):"development"!==De&&t.dispatch(u(e)))}(Be);var Ge=new I("http://localhost:4000");Ge.onStatus=function(t){return console.log("room status",t)},Ge.createRoom(),C(le.effects(Be)),C(et.effects(Be)),C(St.init());var qe=document.getElementById("app");ve.a.setAppElement(qe),i.a.render(a.a.createElement(s.a,{store:Fe},a.a.createElement(Ie,null)),qe)},73:function(t,e,n){t.exports=n(126)}},[[73,2,1]]]);
//# sourceMappingURL=main.c88dde1b.chunk.js.map